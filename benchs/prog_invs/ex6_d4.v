From mathcomp Require Import ssreflect.
Require Import Reals.
From ValidSDP Require Import validsdp.

Local Open Scope R_scope.

(* Attempt to prove that p >= 0 with p below is an
 * inductive invariant, for the program
 *
x1 = rand(0.9, 1.1);
x2 = rand(0, 0.2);
x3 = rand(0, 0.2);
x4 = rand(0, 0.2);
while (-1 <= 0) {
  pre_x1 = x1; pre_x2 = x2; pre_x3 = x3; pre_x4 = x4;
  if (x1^2 + x2^2 + x3^2 + x4^2 <= 1) {
    x1 = 0.25 * (0.8 * pre_x1^2 + 1.4 * pre_x2 - 0.5 * pre_x3^2);
    x2 = 0.25 * (1.3 * pre_x1 + 0.5 * pre_x2^2 - 0.8 * pre_x4^2);
    x3 = 0.25 * (0.8 * pre_x3^2 + 1.4 * pre_x4);
    x4 = 0.25 * (1.3 * pre_x3 + 0.5 * pre_x4^2);
  } else {
    x1 = 0.25 * (0.5 * pre_x1 + 0.4 * pre_x2^2);
    x2 = 0.25 * (-0.6 * pre_x1^2 + 0.3 * pre_x2^2);
    x3 = 0.25 * (0.5 * pre_x3 + 0.4 * pre_x4^2);
    x4 = 0.25 * (-0.6 * pre_x3 + 0.3 * pre_x4^2);
  }
}
 *)

(* initial condition 0.9 <= x1 <= 1.1 encoded as (x1 - 0.9)*(1.1 - x1) (>= 0) *)
Let pI1 (x0 x1 x2 x3 : R) := (x0 - 9 / 10) * (11 / 10 - x0).
(* initial condition 0 <= x2 <= 0.2 *)
Let pI2 (x0 x1 x2 x3 : R) := x1 * (2 / 10 - x1).
(* initial condition 0 <= x3 <= 0.2 *)
Let pI3 (x0 x1 x2 x3 : R) := x2 * (2 / 10 - x2).
(* initial condition 0 <= x4 <= 0.2 *)
Let pI4 (x0 x1 x2 x3 : R) := x3 * (2 / 10 - x3).
(* guard x1^2 + x2^2 + x3^2 + x4^2 <= 1 (then branch) *)
Let g0 (x0 x1 x2 x3 : R) := 1 - (x0^2 + x1^2 + x2^2 + x3^2).
(* assignment in then branch *)
Let t0_x0 (x0 x1 x2 x3 : R) := 1 / 4 * (8 / 10 * x0^2 + 14 / 10 * x1 - 5 / 10 * x2^2).
Let t0_x1 (x0 x1 x2 x3 : R) := 1 / 4 * (13 / 10 * x0 + 5 / 10 * x1^2 - 8 / 10 * x3^2).
Let t0_x2 (x0 x1 x2 x3 : R) := 1 / 4 * (8 / 10 * x2^2 + 14 / 10 * x3).
Let t0_x3 (x0 x1 x2 x3 : R) := 1 / 4 * (13 / 10 * x2 + 5 / 10 * x3^2).

(* guard x1^2 + x2^2 + x3^2 + x4^2 >= 1 (else branch) *)
Let g1 (x0 x1 x2 x3 : R) := (x0^2 + x1^2 + x2^2 + x3^2) - 1.
(* assignment in else branch *)
Let t1_x0 (x0 x1 x2 x3 : R) := 1 / 4 * (5 / 10 * x0 + 4 / 10 * x1^2).
Let t1_x1 (x0 x1 x2 x3 : R) := 1 / 4 * ((-6) / 10 * x0^2 + 3 / 10 * x1^2).
Let t1_x2 (x0 x1 x2 x3 : R) := 1 / 4 * (5 / 10 * x2 + 4 / 10 * x3^2).
Let t1_x3 (x0 x1 x2 x3 : R) := 1 / 4 * ((-6) / 10 * x2 + 3 / 10 * x3^2).

Let p x0 x1 x2 x3 :=
  48940054069273278153/36893488147419103232
  + 5694253208528417/36893488147419103232 * x0
  + 8102901656505047/73786976294838206464 * x1
  + 6269474379387387/147573952589676412928 * x2
  + 3441584900231701/73786976294838206464 * x3
  + -4669554109426427/4503599627370496 * x0^2
  + 92085480506231/288230376151711744 * x0 * x1
  + -5598335104289841/4503599627370496 * x1^2
  + 1843119203387555/9007199254740992 * x0 * x2
  + 1461108288648583/9007199254740992 * x1 * x2
  + -8892369674005945/4503599627370496 * x2^2
  + 3683663009832627/18014398509481984 * x0 * x3
  + 4279969919285975/144115188075855872 * x1 * x3
  + 4599270683968915/4503599627370496 * x2 * x3
  + -2426931813006713/1125899906842624 * x3^2
  + 5679646795147455/288230376151711744 * x0^3
  + 6898152399613459/288230376151711744 * x0^2 * x1
  + 7964854552138401/288230376151711744 * x0 * x1^2
  + -7996748256319621/288230376151711744 * x1^3
  + -3558136104620279/72057594037927936 * x0^2 * x2
  + -8703141464088499/288230376151711744 * x0 * x1 * x2
  + -6898701029652147/144115188075855872 * x1^2 * x2
  + 1876121044027675/2251799813685248 * x0 * x2^2
  + -4463283652912723/18014398509481984 * x1 * x2^2
  + -2162885693276891/72057594037927936 * x2^3
  + -5398056230914363/72057594037927936 * x0^2 * x3
  + 5474141078075247/72057594037927936 * x0 * x1 * x3
  + 5834256714415749/288230376151711744 * x1^2 * x3
  + -8201190208057061/4503599627370496 * x0 * x2 * x3
  + 5783137378410261/9007199254740992 * x1 * x2 * x3
  + 4519517124910863/72057594037927936 * x2^2 * x3
  + 5564976919447915/4503599627370496 * x0 * x3^2
  + -4032767964075663/9007199254740992 * x1 * x3^2
  + -5705740165923223/36028797018963968 * x2 * x3^2
  + 5632093774890191/36028797018963968 * x3^3
  + -5678805155964555/576460752303423488 * x0^4
  + 7449854677957833/576460752303423488 * x0^3 * x1
  + -2627994069062625/576460752303423488 * x0^2 * x1^2
  + 8725945813410821/18446744073709551616 * x0 * x1^3
  + -8911675626378479/9223372036854775808 * x1^4
  + 5585412167840481/1152921504606846976 * x0^3 * x2
  + -4131646996160293/576460752303423488 * x0^2 * x1 * x2
  + 7067301336180357/576460752303423488 * x0 * x1^2 * x2
  + -444139637288545/144115188075855872 * x1^3 * x2
  + -549762786449193/2251799813685248 * x0^2 * x2^2
  + 239478656343597/2251799813685248 * x0 * x1 * x2^2
  + -1878441530106213/18014398509481984 * x1^2 * x2^2
  + 4223954103278339/72057594037927936 * x0 * x2^3
  + -3983274901088115/72057594037927936 * x1 * x2^3
  + -2592136743387799/4503599627370496 * x2^4
  + 1611594838859253/288230376151711744 * x0^3 * x3
  + 7250209135848541/4611686018427387904 * x0^2 * x1 * x3
  + -1227179578630901/144115188075855872 * x0 * x1^2 * x3
  + -2073325184724095/9223372036854775808 * x1^3 * x3
  + 5365581902893101/9007199254740992 * x0^2 * x2 * x3
  + -8972440832492619/36028797018963968 * x0 * x1 * x2 * x3
  + 4571320738466443/18014398509481984 * x1^2 * x2 * x3
  + -5260570922044893/288230376151711744 * x0 * x2^2 * x3
  + 5786032707896575/72057594037927936 * x1 * x2^2 * x3
  + 5865540286708361/2251799813685248 * x2^3 * x3
  + -465574218383891/1125899906842624 * x0^2 * x3^2
  + 3181253618894765/18014398509481984 * x0 * x1 * x3^2
  + -6165504408072355/36028797018963968 * x1^2 * x3^2
  + -8236815771369237/36028797018963968 * x0 * x2 * x3^2
  + 1131632067628285/18014398509481984 * x1 * x2 * x3^2
  + -5528298683556665/1125899906842624 * x2^2 * x3^2
  + 8301825989304093/36028797018963968 * x0 * x3^3
  + -4013672348018387/36028797018963968 * x1 * x3^3
  + 2626355412004073/562949953421312 * x2 * x3^3
  + -4180528354014335/2251799813685248 * x3^4.
  
Let init_sigma1 x0 x1 x2 x3 :=
  7465136710350525/2251799813685248 + 1344662882676777/562949953421312 * 
  x0 + 380166431208319/1125899906842624 * x1
  + 713594193624619/2251799813685248 * x2
  + 6244643721770433/18014398509481984 * x3
  + 8115750695510989/2251799813685248 * x0^2
  + 4937441718018011/18014398509481984 * x0 * x1
  + 653523010249489/281474976710656 * x1^2
  + 8419513758837853/36028797018963968 * x0 * x2
  + 5591834714361883/144115188075855872 * x1 * x2
  + 5494347485237837/2251799813685248 * x2^2
  + 4478538784980011/18014398509481984 * x0 * x3
  + 1060091596637071/18014398509481984 * x1 * x3
  + -7283295463387043/36028797018963968 * x2 * x3
  + 87911944845119/35184372088832 * x3^2.
  
Let init_sigma2 x0 x1 x2 x3 :=
  911856567243271/562949953421312 + -4988841739485831/4503599627370496 * 
  x0 + -2525923086257431/18014398509481984 * x1
  + -6899137227181691/18014398509481984 * x2
  + -3366733108759533/9007199254740992 * x3
  + 50190277537903/35184372088832 * x0^2
  + -5256400967963321/18014398509481984 * x0 * x1
  + 3626577326010435/1125899906842624 * x1^2
  + -4012329684927251/9007199254740992 * x0 * x2
  + -4092293001892351/36028797018963968 * x1 * x2
  + 1355067888269093/562949953421312 * x2^2
  + -119967697141965/281474976710656 * x0 * x3
  + -7634605852584421/72057594037927936 * x1 * x3
  + -4949125344868927/36028797018963968 * x2 * x3
  + 5439406637802075/2251799813685248 * x3^2.
  
Let init_sigma3 x0 x1 x2 x3 :=
  3863161093301597/2251799813685248 + -1321776729279811/1125899906842624 * 
  x0 + -5861126570211581/18014398509481984 * x1
  + -7211851567224859/36028797018963968 * x2
  + -1258877510760519/4503599627370496 * x3
  + 779822294899505/562949953421312 * x0^2
  + -7853355257433127/18014398509481984 * x0 * x1
  + 2707352892867005/1125899906842624 * x1^2
  + -6730406004681163/18014398509481984 * x0 * x2
  + -976204349426611/9007199254740992 * x1 * x2
  + 8672135062912535/2251799813685248 * x2^2
  + -3248595990105709/9007199254740992 * x0 * x3
  + -3957854271347767/36028797018963968 * x1 * x3
  + -3580038621935585/2251799813685248 * x2 * x3
  + 993886694303095/281474976710656 * x3^2.
  
Let init_sigma4 x0 x1 x2 x3 :=
  3960703315019473/2251799813685248 + -1349472314287735/1125899906842624 * 
  x0 + -8806672138636097/36028797018963968 * x1
  + -823866513064113/2251799813685248 * x2
  + -1907067698240803/9007199254740992 * x3
  + 193770958797563/140737488355328 * x0^2
  + -3583376915602755/9007199254740992 * x0 * x1
  + 2720281521794445/1125899906842624 * x1^2
  + -5819442950955231/18014398509481984 * x0 * x2
  + -2268105837760519/18014398509481984 * x1 * x2
  + 8269591901380503/2251799813685248 * x2^2
  + -1167439316202823/2251799813685248 * x0 * x3
  + -5315266139242921/72057594037927936 * x1 * x3
  + -5954905066902267/2251799813685248 * x2 * x3
  + 5507079171205495/1125899906842624 * x3^2.
  
Let ind0_sigma x0 x1 x2 x3 :=
  2539951447752603/9007199254740992
  + 2535794994096903/144115188075855872 * x0
  + -5937327317315255/576460752303423488 * x1
  + -6252288507175293/1152921504606846976 * x2
  + 3856490258716911/4611686018427387904 * x3
  + 1877251170759683/9007199254740992 * x0^2
  + 7516587624410321/4611686018427387904 * x0 * x1
  + 2094525728036281/9007199254740992 * x1^2
  + -5207726526829135/1152921504606846976 * x0 * x2
  + 4304683144082205/4611686018427387904 * x1 * x2
  + 8635997272541785/36028797018963968 * x2^2
  + 7490887883461687/4611686018427387904 * x0 * x3
  + -5253764403262921/9223372036854775808 * x1 * x3
  + 2894352025608295/18014398509481984 * x2 * x3
  + 3870190443128119/18014398509481984 * x3^2
  + 3133582047012865/288230376151711744 * x0^3
  + -4692281697147103/576460752303423488 * x0^2 * x1
  + 4486791505001061/288230376151711744 * x0 * x1^2
  + -5279273305212043/1152921504606846976 * x1^3
  + -1105277477738911/576460752303423488 * x0^2 * x2
  + -5101164715308259/73786976294838206464 * x0 * x1 * x2
  + -5090827765326813/2305843009213693952 * x1^2 * x2
  + 4613142320200983/288230376151711744 * x0 * x2^2
  + -5237268559305899/1152921504606846976 * x1 * x2^2
  + -4771163016881733/1152921504606846976 * x2^3
  + 418732141413839/144115188075855872 * x0^2 * x3
  + 3307704159148067/4611686018427387904 * x0 * x1 * x3
  + 2534085579606949/1152921504606846976 * x1^2 * x3
  + -671963539977527/72057594037927936 * x0 * x2 * x3
  + 6056291224704039/2305843009213693952 * x1 * x2 * x3
  + -7867884784228809/2305843009213693952 * x2^2 * x3
  + 3295361987477133/144115188075855872 * x0 * x3^2
  + -8322845382869711/1152921504606846976 * x1 * x3^2
  + -6505746207202841/2305843009213693952 * x2 * x3^2
  + 4046350986568687/9223372036854775808 * x3^3
  + 2267054343406209/9007199254740992 * x0^4
  + 3421631375205387/1152921504606846976 * x0^3 * x1
  + 8077789955323045/36028797018963968 * x0^2 * x1^2
  + 7512196943606407/2305843009213693952 * x0 * x1^3
  + 2403991144802469/9007199254740992 * x1^4
  + -4613936146381137/1152921504606846976 * x0^3 * x2
  + 1447779694492495/2305843009213693952 * x0^2 * x1 * x2
  + -2266103023609965/9223372036854775808 * x0 * x1^2 * x2
  + 8816449140609391/9223372036854775808 * x1^3 * x2
  + 7395806539471741/36028797018963968 * x0^2 * x2^2
  + 8823578072694589/4611686018427387904 * x0 * x1 * x2^2
  + 1863932649590331/9007199254740992 * x1^2 * x2^2
  + -1053883018899795/576460752303423488 * x0 * x2^3
  + 2465604836851093/2305843009213693952 * x1 * x2^3
  + 4593260751103743/18014398509481984 * x2^4
  + 4524812301690011/18446744073709551616 * x0^3 * x3
  + -1497933174811533/9223372036854775808 * x0^2 * x1 * x3
  + 6793635265531507/2305843009213693952 * x0 * x1^2 * x3
  + 4890294271835311/36893488147419103232 * x1^3 * x3
  + 6314828891212353/72057594037927936 * x0^2 * x2 * x3
  + -5190604949896635/4611686018427387904 * x0 * x1 * x2 * x3
  + 3126396108926845/36028797018963968 * x1^2 * x2 * x3
  + 3457397866098985/1152921504606846976 * x0 * x2^2 * x3
  + 5130544244116089/4611686018427387904 * x1 * x2^2 * x3
  + 899627258529457/9007199254740992 * x2^3 * x3
  + 6817905685412023/36028797018963968 * x0^2 * x3^2
  + 2871511460133317/1152921504606846976 * x0 * x1 * x3^2
  + 3451944609309753/18014398509481984 * x1^2 * x3^2
  + 7739071498388289/2305843009213693952 * x0 * x2 * x3^2
  + 8894446398227693/36893488147419103232 * x1 * x2 * x3^2
  + 7375909236259823/36028797018963968 * x2^2 * x3^2
  + 3663821572908073/1152921504606846976 * x0 * x3^3
  + -1943284764680069/2305843009213693952 * x1 * x3^3
  + 7633917343058025/72057594037927936 * x2 * x3^3
  + 8990025464345511/36028797018963968 * x3^4.
  
Let ind0_sigma0 x0 x1 x2 x3 :=
  928607243320647/2251799813685248 + 3011728258807611/288230376151711744 * 
  x0 + -5022828472084579/2305843009213693952 * x1
  + 5971742334162063/9223372036854775808 * x2
  + 5311346933215541/1152921504606846976 * x3
  + 2506616421612263/9007199254740992 * x0^2
  + 1321082507527787/9223372036854775808 * x0 * x1
  + 308159976977707/1125899906842624 * x1^2
  + 4855570343212257/1152921504606846976 * x0 * x2
  + 6021030801437359/2305843009213693952 * x1 * x2
  + 135716326910153/562949953421312 * x2^2
  + 1585282749272287/288230376151711744 * x0 * x3
  + 7650213073819009/4611686018427387904 * x1 * x3
  + 4220886660989787/144115188075855872 * x2 * x3
  + 4042153759687163/18014398509481984 * x3^2
  + 4726700913344015/1152921504606846976 * x0^3
  + -8999666778539561/4611686018427387904 * x0^2 * x1
  + 3360669461340235/4611686018427387904 * x0 * x1^2
  + -6289695262595991/4611686018427387904 * x1^3
  + -3987919391943535/9223372036854775808 * x0^2 * x2
  + 3009430288381285/18446744073709551616 * x0 * x1 * x2
  + -5677251278810573/9223372036854775808 * x1^2 * x2
  + -7926967836256525/73786976294838206464 * x0 * x2^2
  + 863848960128311/288230376151711744 * x1 * x2^2
  + 453882992441351/288230376151711744 * x2^3
  + 5924160374300377/9223372036854775808 * x0^2 * x3
  + 603815928935535/2305843009213693952 * x0 * x1 * x3
  + 1756392162364279/2305843009213693952 * x1^2 * x3
  + 4783694810205193/2305843009213693952 * x0 * x2 * x3
  + -798021329824965/576460752303423488 * x1 * x2 * x3
  + -3170884537188477/576460752303423488 * x2^2 * x3
  + 8395284348174375/9223372036854775808 * x0 * x3^2
  + 6660225310635771/4611686018427387904 * x1 * x3^2
  + -1867463964776217/1152921504606846976 * x2 * x3^2
  + 3354196673793059/2305843009213693952 * x3^3
  + 4693304098395907/18014398509481984 * x0^4
  + -5363731834869489/9223372036854775808 * x0^3 * x1
  + 339212539796557/2251799813685248 * x0^2 * x1^2
  + -919130894763209/1152921504606846976 * x0 * x1^3
  + 4551848594703157/18014398509481984 * x1^4
  + 668277232648881/144115188075855872 * x0^3 * x2
  + 6168909339674581/4611686018427387904 * x0^2 * x1 * x2
  + 5328408658066339/2305843009213693952 * x0 * x1^2 * x2
  + 5951233834072939/2305843009213693952 * x1^3 * x2
  + 2516107400090851/18014398509481984 * x0^2 * x2^2
  + -4427935261314443/9223372036854775808 * x0 * x1 * x2^2
  + 4891774467550523/36028797018963968 * x1^2 * x2^2
  + 4912468098306823/1152921504606846976 * x0 * x2^3
  + 1668375264431535/1152921504606846976 * x1 * x2^3
  + 262764653538461/1125899906842624 * x2^4
  + 2633174959973605/576460752303423488 * x0^3 * x3
  + 736164688396671/1152921504606846976 * x0^2 * x1 * x3
  + 5502543466097371/2305843009213693952 * x0 * x1^2 * x3
  + 8025912811087841/9223372036854775808 * x1^3 * x3
  + 5929298058760549/576460752303423488 * x0^2 * x2 * x3
  + 5542286816466721/9223372036854775808 * x0 * x1 * x2 * x3
  + 3224246567074451/288230376151711744 * x1^2 * x2 * x3
  + 8399388581699085/4611686018427387904 * x0 * x2^2 * x3
  + 8263849924227779/4611686018427387904 * x1 * x2^2 * x3
  + 1133095597458681/576460752303423488 * x2^3 * x3
  + 2401850145970443/18014398509481984 * x0^2 * x3^2
  + -3141433061067561/4611686018427387904 * x0 * x1 * x3^2
  + 4704674565462995/36028797018963968 * x1^2 * x3^2
  + 5157850208817511/2305843009213693952 * x0 * x2 * x3^2
  + 809203318739467/576460752303423488 * x1 * x2 * x3^2
  + 4853345067769117/36028797018963968 * x2^2 * x3^2
  + 2109024744479087/576460752303423488 * x0 * x3^3
  + 2967479226626761/18446744073709551616 * x1 * x3^3
  + -8724089193179895/2305843009213693952 * x2 * x3^3
  + 1032967467242591/4503599627370496 * x3^4
  + 1884365306681881/144115188075855872 * x0^5
  + -4958539481221807/2305843009213693952 * x0^4 * x1
  + 1178594851348185/288230376151711744 * x0^3 * x1^2
  + -2529899799521461/2305843009213693952 * x0^2 * x1^3
  + 4856076334174913/576460752303423488 * x0 * x1^4
  + -3128405785913675/576460752303423488 * x1^5
  + -43582614396521/18014398509481984 * x0^4 * x2
  + -5194591058958417/18446744073709551616 * x0^3 * x1 * x2
  + -6289931322156173/4611686018427387904 * x0^2 * x1^2 * x2
  + -5709591281354033/18446744073709551616 * x0 * x1^3 * x2
  + -2298235002929867/1152921504606846976 * x1^4 * x2
  + 2542764706082867/288230376151711744 * x0^3 * x2^2
  + -5073119631138065/4611686018427387904 * x0^2 * x1 * x2^2
  + 879078283346981/144115188075855872 * x0 * x1^2 * x2^2
  + -5210042686541739/2305843009213693952 * x1^3 * x2^2
  + -3128130185523619/2305843009213693952 * x0^2 * x2^3
  + -3261151165361795/9223372036854775808 * x0 * x1 * x2^3
  + -1094442654932183/1152921504606846976 * x1^2 * x2^3
  + 7056014591222637/576460752303423488 * x0 * x2^4
  + -190616217126375/72057594037927936 * x1 * x2^4
  + -5852275657633463/18446744073709551616 * x2^5
  + -2645840431855517/36893488147419103232 * x0^4 * x3
  + 7736207962129865/9223372036854775808 * x0^3 * x1 * x3
  + -1451960298858185/9223372036854775808 * x0^2 * x1^2 * x3
  + 3801269156759643/4611686018427387904 * x0 * x1^3 * x3
  + 6272279220347215/4611686018427387904 * x1^4 * x3
  + -6343091627469595/576460752303423488 * x0^3 * x2 * x3
  + 1323950659122315/576460752303423488 * x0^2 * x1 * x2 * x3
  + -1052551893161083/144115188075855872 * x0 * x1^2 * x2 * x3
  + 4511894214152551/1152921504606846976 * x1^3 * x2 * x3
  + -2422675338346223/2305843009213693952 * x0^2 * x2^2 * x3
  + 7231564841264379/18446744073709551616 * x0 * x1 * x2^2 * x3
  + -1379459096454199/2305843009213693952 * x1^2 * x2^2 * x3
  + -1275568520659349/288230376151711744 * x0 * x2^3 * x3
  + 1220120925614859/576460752303423488 * x1 * x2^3 * x3
  + -1208241674010389/576460752303423488 * x2^4 * x3
  + 3262371358422053/288230376151711744 * x0^3 * x3^2
  + -5009154856739181/2305843009213693952 * x0^2 * x1 * x3^2
  + 4531614132270547/576460752303423488 * x0 * x1^2 * x3^2
  + -4892432393069019/1152921504606846976 * x1^3 * x3^2
  + -7085760742821891/4611686018427387904 * x0^2 * x2 * x3^2
  + 3675286010521483/9223372036854775808 * x0 * x1 * x2 * x3^2
  + -8170391661554997/9223372036854775808 * x1^2 * x2 * x3^2
  + -3375168775342487/4611686018427387904 * x0 * x2^2 * x3^2
  + 6577285129934459/18446744073709551616 * x1 * x2^2 * x3^2
  + -671313619343405/576460752303423488 * x2^3 * x3^2
  + 8535995343911619/9223372036854775808 * x0^2 * x3^3
  + 5027113591049621/18446744073709551616 * x0 * x1 * x3^3
  + 950894441103539/576460752303423488 * x1^2 * x3^3
  + 3359419511027489/2305843009213693952 * x0 * x2 * x3^3
  + -6009568989365813/36893488147419103232 * x1 * x2 * x3^3
  + -3455503918308033/9223372036854775808 * x2^2 * x3^3
  + 6565274715891341/576460752303423488 * x0 * x3^4
  + -69918769371903/18014398509481984 * x1 * x3^4
  + -755084415605235/1152921504606846976 * x2 * x3^4
  + 6950510288126191/2305843009213693952 * x3^5
  + 1069838404726623/2251799813685248 * x0^6
  + 533239501175907/288230376151711744 * x0^5 * x1
  + 638031673123113/2251799813685248 * x0^4 * x1^2
  + 3227616052883039/4611686018427387904 * x0^3 * x1^3
  + 5083434728034815/18014398509481984 * x0^2 * x1^4
  + 6714059968562013/4611686018427387904 * x0 * x1^5
  + 4317014305641191/9007199254740992 * x1^6
  + 2125767768062821/18446744073709551616 * x0^5 * x2
  + -7957712020469633/9223372036854775808 * x0^4 * x1 * x2
  + 7994433820434387/73786976294838206464 * x0^3 * x1^2 * x2
  + -4960341865086105/9223372036854775808 * x0^2 * x1^3 * x2
  + -4713398792014249/73786976294838206464 * x0 * x1^4 * x2
  + -5284569219203673/4611686018427387904 * x1^5 * x2
  + 2330171387050459/9007199254740992 * x0^4 * x2^2
  + 2940268620737177/2305843009213693952 * x0^3 * x1 * x2^2
  + 5775940800801365/36028797018963968 * x0^2 * x1^2 * x2^2
  + 167401888673679/144115188075855872 * x0 * x1^3 * x2^2
  + 2342479840511839/9007199254740992 * x1^4 * x2^2
  + 2016089655385847/1152921504606846976 * x0^3 * x2^3
  + -4697136819349725/4611686018427387904 * x0^2 * x1 * x2^3
  + 7765747621543205/9223372036854775808 * x0 * x1^2 * x2^3
  + -7737865422286865/4611686018427387904 * x1^3 * x2^3
  + 4888390715001803/18014398509481984 * x0^2 * x2^4
  + 4122668886954673/2305843009213693952 * x0 * x1 * x2^4
  + 4941048615968453/18014398509481984 * x1^2 * x2^4
  + 3051635219450357/2305843009213693952 * x0 * x2^5
  + -167353847647673/72057594037927936 * x1 * x2^5
  + 2001209616876529/4503599627370496 * x2^6
  + 7334767426573617/4611686018427387904 * x0^5 * x3
  + -1318474701271705/4611686018427387904 * x0^4 * x1 * x3
  + 5179242600744053/36893488147419103232 * x0^3 * x1^2 * x3
  + -6430762860516417/147573952589676412928 * x0^2 * x1^3 * x3
  + 7280372652823089/9223372036854775808 * x0 * x1^4 * x3
  + -6708392374891865/9223372036854775808 * x1^5 * x3
  + 1807508571979071/36028797018963968 * x0^4 * x2 * x3
  + -3729811720488995/2305843009213693952 * x0^3 * x1 * x2 * x3
  + 3032651751510727/144115188075855872 * x0^2 * x1^2 * x2 * x3
  + -8329898458369133/4611686018427387904 * x0 * x1^3 * x2 * x3
  + 217860328802547/4503599627370496 * x1^4 * x2 * x3
  + -3929955581134441/2305843009213693952 * x0^3 * x2^2 * x3
  + 6140570517990969/9223372036854775808 * x0^2 * x1 * x2^2 * x3
  + -1868119984635739/2305843009213693952 * x0 * x1^2 * x2^2 * x3
  + 762648251148287/576460752303423488 * x1^3 * x2^2 * x3
  + 2523022264799305/72057594037927936 * x0^2 * x2^3 * x3
  + -3374165973591049/4611686018427387904 * x0 * x1 * x2^3 * x3
  + 1219429239242591/36028797018963968 * x1^2 * x2^3 * x3
  + -3376313315153309/4611686018427387904 * x0 * x2^4 * x3
  + 7773610327061037/18446744073709551616 * x1 * x2^4 * x3
  + 2475348399238005/36028797018963968 * x2^5 * x3
  + 8639675630684177/36028797018963968 * x0^4 * x3^2
  + 2181738916169377/1152921504606846976 * x0^3 * x1 * x3^2
  + 1377250504740739/9007199254740992 * x0^2 * x1^2 * x3^2
  + 263001327756775/144115188075855872 * x0 * x1^3 * x3^2
  + 2183135182724533/9007199254740992 * x1^4 * x3^2
  + -8042663632821333/4611686018427387904 * x0^3 * x2 * x3^2
  + 5659724880793977/73786976294838206464 * x0^2 * x1 * x2 * x3^2
  + -3145123939846735/2305843009213693952 * x0 * x1^2 * x2 * x3^2
  + 1405368881911471/4611686018427387904 * x1^3 * x2 * x3^2
  + 2300945169421931/18014398509481984 * x0^2 * x2^2 * x3^2
  + -2452123404163457/18446744073709551616 * x0 * x1 * x2^2 * x3^2
  + 575264526719827/4503599627370496 * x1^2 * x2^2 * x3^2
  + -3180212194733459/2305843009213693952 * x0 * x2^3 * x3^2
  + 1490361002071371/2305843009213693952 * x1 * x2^3 * x3^2
  + 4143797446609779/18014398509481984 * x2^4 * x3^2
  + 1994798152842045/576460752303423488 * x0^3 * x3^3
  + -2796006318020979/2305843009213693952 * x0^2 * x1 * x3^3
  + 2461153858159303/1152921504606846976 * x0 * x1^2 * x3^3
  + -5394749219509979/2305843009213693952 * x1^3 * x3^3
  + 6923662442541163/144115188075855872 * x0^2 * x2 * x3^3
  + 1903567693826955/4611686018427387904 * x0 * x1 * x2 * x3^3
  + 877328319027599/18014398509481984 * x1^2 * x2 * x3^3
  + -4940597036670695/4611686018427387904 * x0 * x2^2 * x3^3
  + 2252246299794987/18446744073709551616 * x1 * x2^2 * x3^3
  + 5868287671549109/144115188075855872 * x2^3 * x3^3
  + 1135336964776495/4503599627370496 * x0^2 * x3^4
  + 8538584919811069/4611686018427387904 * x0 * x1 * x3^4
  + 2303476094702817/9007199254740992 * x1^2 * x3^4
  + 8009461487718301/9223372036854775808 * x0 * x2 * x3^4
  + -6777949692119759/4611686018427387904 * x1 * x2 * x3^4
  + 4514788005783327/18014398509481984 * x2^2 * x3^4
  + 4101231744568385/1152921504606846976 * x0 * x3^5
  + -352850377504421/144115188075855872 * x1 * x3^5
  + 4664344458971049/72057594037927936 * x2 * x3^5
  + 7317444005086061/18014398509481984 * x3^6.
  
Let ind1_sigma x0 x1 x2 x3 :=
  4796444738712949/9007199254740992 + 351698991245823/9007199254740992 * 
  x0 + -1914920912507497/144115188075855872 * x1
  + -432295497483773/72057594037927936 * x2
  + 4786137771903269/1152921504606846976 * x3
  + 8140639617947503/18014398509481984 * x0^2
  + -8857366271844931/576460752303423488 * x0 * x1
  + 2018287910248293/4503599627370496 * x1^2
  + 5196733458104405/2305843009213693952 * x0 * x2
  + 1324875530823913/144115188075855872 * x1 * x2
  + 6865655635193377/18014398509481984 * x2^2
  + 7901805054766677/576460752303423488 * x0 * x3
  + 6183815672800415/2305843009213693952 * x1 * x3
  + 5312574782406069/18014398509481984 * x2 * x3
  + 2659385701390231/9007199254740992 * x3^2
  + 8306942596307923/72057594037927936 * x0^3
  + -4799059340993641/288230376151711744 * x0^2 * x1
  + 6022558556361989/72057594037927936 * x0 * x1^2
  + -3089018255286673/72057594037927936 * x1^3
  + -3037325020990671/288230376151711744 * x0^2 * x2
  + -4216108770497101/4611686018427387904 * x0 * x1 * x2
  + -1614121782085719/144115188075855872 * x1^2 * x2
  + 709398788286663/9007199254740992 * x0 * x2^2
  + -3453493179136621/144115188075855872 * x1 * x2^2
  + -7881521185134523/576460752303423488 * x2^3
  + 4332114160437877/576460752303423488 * x0^2 * x3
  + 2896589812296869/9223372036854775808 * x0 * x1 * x3
  + 6917208322459521/1152921504606846976 * x1^2 * x3
  + 3947424994486275/144115188075855872 * x0 * x2 * x3
  + -7786869468617255/1152921504606846976 * x1 * x2 * x3
  + -8046102058416327/2305843009213693952 * x2^2 * x3
  + 5197202823914691/72057594037927936 * x0 * x3^2
  + -3579436936781575/144115188075855872 * x1 * x3^2
  + 2661009422849845/9223372036854775808 * x2 * x3^2
  + 7254312563536425/1152921504606846976 * x3^3
  + 4620338293017089/4503599627370496 * x0^4
  + 1041392614416197/9007199254740992 * x0^3 * x1
  + 5211004880928069/4503599627370496 * x0^2 * x1^2
  + 5746681376307975/36028797018963968 * x0 * x1^3
  + 3030478413646979/2251799813685248 * x1^4
  + 3190746896297643/72057594037927936 * x0^3 * x2
  + 5296192564070335/288230376151711744 * x0^2 * x1 * x2
  + 8568217034692143/144115188075855872 * x0 * x1^2 * x2
  + -2293458140054809/36028797018963968 * x1^3 * x2
  + 7223915268945781/9007199254740992 * x0^2 * x2^2
  + 6087830205931527/144115188075855872 * x0 * x1 * x2^2
  + 1969370734406517/2251799813685248 * x1^2 * x2^2
  + 2036402398095333/36028797018963968 * x0 * x2^3
  + -3603638957047207/144115188075855872 * x1 * x2^3
  + 488645079671879/562949953421312 * x2^4
  + 4525657854950643/72057594037927936 * x0^3 * x3
  + 3756026992050701/288230376151711744 * x0^2 * x1 * x3
  + 4529576125247997/72057594037927936 * x0 * x1^2 * x3
  + -2184419253147959/36028797018963968 * x1^3 * x3
  + 5420573435220877/9007199254740992 * x0^2 * x2 * x3
  + 2576191303079215/72057594037927936 * x0 * x1 * x2 * x3
  + 5997182024171181/9007199254740992 * x1^2 * x2 * x3
  + 7322238212172991/72057594037927936 * x0 * x2^2 * x3
  + -5948974538626277/144115188075855872 * x1 * x2^2 * x3
  + 4047496178850159/4503599627370496 * x2^3 * x3
  + 2631891903149327/4503599627370496 * x0^2 * x3^2
  + 6927072371682961/288230376151711744 * x0 * x1 * x3^2
  + 703011959118049/1125899906842624 * x1^2 * x3^2
  + 5746556720919575/72057594037927936 * x0 * x2 * x3^2
  + -2346694662344489/72057594037927936 * x1 * x2 * x3^2
  + 8770350278254015/9007199254740992 * x2^2 * x3^2
  + 5889980744170341/144115188075855872 * x0 * x3^3
  + -2264717894709191/144115188075855872 * x1 * x3^3
  + 5281259792115913/9007199254740992 * x2 * x3^3
  + 2521749585067753/4503599627370496 * x3^4.
  
Let ind1_sigma1 x0 x1 x2 x3 :=
  1296949721442599/4503599627370496
  + -6419314913442625/576460752303423488 * x0
  + 8548427250039487/2305843009213693952 * x1
  + 3010614765124671/576460752303423488 * x2
  + -294024813337175/144115188075855872 * x3
  + 2800790442904947/18014398509481984 * x0^2
  + 7096089448092541/1152921504606846976 * x0 * x1
  + 1180447290655003/4503599627370496 * x1^2
  + -1209692683330179/36028797018963968 * x0 * x2
  + -2015064324986387/144115188075855872 * x1 * x2
  + 827152743937177/2251799813685248 * x2^2
  + -4697551491326465/144115188075855872 * x0 * x3
  + -7887390743674579/1152921504606846976 * x1 * x3
  + -2479204664892437/36028797018963968 * x2 * x3
  + 3521526013775713/9007199254740992 * x3^2
  + 2639972965950835/72057594037927936 * x0^3
  + -4497168759906099/576460752303423488 * x0^2 * x1
  + 5771114048459075/288230376151711744 * x0 * x1^2
  + -8720892138463435/1152921504606846976 * x1^3
  + 3428433293106805/576460752303423488 * x0^2 * x2
  + -485954673320169/2305843009213693952 * x0 * x1 * x2
  + 5883640430645325/2305843009213693952 * x1^2 * x2
  + -7096994703165431/4611686018427387904 * x0 * x2^2
  + -3151896194663515/2305843009213693952 * x1 * x2^2
  + -8314342880293777/2305843009213693952 * x2^3
  + 5229351214947069/1152921504606846976 * x0^2 * x3
  + -8393856107519937/36893488147419103232 * x0 * x1 * x3
  + -651311637039975/2305843009213693952 * x1^2 * x3
  + 6572454422643575/576460752303423488 * x0 * x2 * x3
  + -638428046108577/288230376151711744 * x1 * x2 * x3
  + 5309157375188387/1152921504606846976 * x2^2 * x3
  + -7513319798038839/1152921504606846976 * x0 * x3^2
  + 2387456165969925/2305843009213693952 * x1 * x3^2
  + -3047849248481571/1152921504606846976 * x2 * x3^2
  + -3706354527681273/576460752303423488 * x3^3
  + 6394609313759717/18014398509481984 * x0^4
  + 4123307154926179/288230376151711744 * x0^3 * x1
  + 6332440894120181/18014398509481984 * x0^2 * x1^2
  + 7058037815041165/288230376151711744 * x0 * x1^3
  + 546041659111197/1125899906842624 * x1^4
  + -7688958348603089/288230376151711744 * x0^3 * x2
  + -1516671853568601/288230376151711744 * x0^2 * x1 * x2
  + -8728374828873713/1152921504606846976 * x0 * x1^2 * x2
  + -3452431443598327/288230376151711744 * x1^3 * x2
  + 6544647385129067/18014398509481984 * x0^2 * x2^2
  + 7591631251240139/1152921504606846976 * x0 * x1 * x2^2
  + 6931767178622355/18014398509481984 * x1^2 * x2^2
  + -8533068790301407/1152921504606846976 * x0 * x2^3
  + -8549211684106303/1152921504606846976 * x1 * x2^3
  + 2198984872873299/4503599627370496 * x2^4
  + -7123175369057437/288230376151711744 * x0^3 * x3
  + -3029695259518743/2305843009213693952 * x0^2 * x1 * x3
  + -5132387409940215/576460752303423488 * x0 * x1^2 * x3
  + -8895211272353751/2305843009213693952 * x1^3 * x3
  + 5038044091193761/576460752303423488 * x0^2 * x2 * x3
  + -5714643805900437/36893488147419103232 * x0 * x1 * x2 * x3
  + 697111500041555/36028797018963968 * x1^2 * x2 * x3
  + -1691620799126671/288230376151711744 * x0 * x2^2 * x3
  + -3253477941013555/576460752303423488 * x1 * x2^2 * x3
  + 1880552599886193/36028797018963968 * x2^3 * x3
  + 1605736681567433/4503599627370496 * x0^2 * x3^2
  + 809269268292575/144115188075855872 * x0 * x1 * x3^2
  + 1653857893826973/4503599627370496 * x1^2 * x3^2
  + -7638061626452757/1152921504606846976 * x0 * x2 * x3^2
  + -2113825345591835/576460752303423488 * x1 * x2 * x3^2
  + 5957911958783277/18014398509481984 * x2^2 * x3^2
  + -1606264853894617/288230376151711744 * x0 * x3^3
  + -4308084383549545/2305843009213693952 * x1 * x3^3
  + 1061448024401171/18014398509481984 * x2 * x3^3
  + 4286357258443173/9007199254740992 * x3^4
  + -2778167728494495/288230376151711744 * x0^5
  + -8158612660036449/2305843009213693952 * x0^4 * x1
  + -4614011318470843/2305843009213693952 * x0^3 * x1^2
  + -1317203324577641/288230376151711744 * x0^2 * x1^3
  + -2002074671842681/144115188075855872 * x0 * x1^4
  + 5961571296640619/576460752303423488 * x1^5
  + 7835827769962447/576460752303423488 * x0^4 * x2
  + 4969632828845581/2305843009213693952 * x0^3 * x1 * x2
  + 1791512387558029/144115188075855872 * x0^2 * x1^2 * x2
  + 1028913467653845/288230376151711744 * x0 * x1^3 * x2
  + 8557035979067783/576460752303423488 * x1^4 * x2
  + -380313257887943/9007199254740992 * x0^3 * x2^2
  + -2980293692839057/18446744073709551616 * x0^2 * x1 * x2^2
  + -2255663838606815/72057594037927936 * x0 * x1^2 * x2^2
  + 335881110897999/36028797018963968 * x1^3 * x2^2
  + 8390752357993881/1152921504606846976 * x0^2 * x2^3
  + 8908446609149899/4611686018427387904 * x0 * x1 * x2^3
  + 8433022860020225/1152921504606846976 * x1^2 * x2^3
  + -7613016980691497/144115188075855872 * x0 * x2^4
  + 3441777969619969/288230376151711744 * x1 * x2^4
  + 593984323299637/144115188075855872 * x2^5
  + 4188117906498849/576460752303423488 * x0^4 * x3
  + -7552164935927053/1152921504606846976 * x0^3 * x1 * x3
  + 6722359218579737/1152921504606846976 * x0^2 * x1^2 * x3
  + -8323049429452357/1152921504606846976 * x0 * x1^3 * x3
  + -1038807996825461/144115188075855872 * x1^4 * x3
  + 7988164727199919/144115188075855872 * x0^3 * x2 * x3
  + -1043188555707221/72057594037927936 * x0^2 * x1 * x2 * x3
  + 4627304196918921/144115188075855872 * x0 * x1^2 * x2 * x3
  + -5283009636638881/288230376151711744 * x1^3 * x2 * x3
  + 1883053723858251/144115188075855872 * x0^2 * x2^2 * x3
  + -8569183816770239/2305843009213693952 * x0 * x1 * x2^2 * x3
  + 5276439508475191/1152921504606846976 * x1^2 * x2^2 * x3
  + 6134284285368315/288230376151711744 * x0 * x2^3 * x3
  + -5391487900573485/576460752303423488 * x1 * x2^3 * x3
  + 7003625363899543/9223372036854775808 * x2^4 * x3
  + -3163000430586519/72057594037927936 * x0^3 * x3^2
  + 2304188984306681/288230376151711744 * x0^2 * x1 * x3^2
  + -4547684205085653/144115188075855872 * x0 * x1^2 * x3^2
  + 4917331587349307/288230376151711744 * x1^3 * x3^2
  + 3456257869464457/288230376151711744 * x0^2 * x2 * x3^2
  + -1493457420071483/288230376151711744 * x0 * x1 * x2 * x3^2
  + 5801932084053291/2305843009213693952 * x1^2 * x2 * x3^2
  + 5644355864709371/288230376151711744 * x0 * x2^2 * x3^2
  + -8015546178157557/1152921504606846976 * x1 * x2^2 * x3^2
  + 30087710404489/18014398509481984 * x2^3 * x3^2
  + -3942384139299309/576460752303423488 * x0^2 * x3^3
  + -6114710622003539/4611686018427387904 * x0 * x1 * x3^3
  + -4249738981760163/576460752303423488 * x1^2 * x3^3
  + -2457719005043749/288230376151711744 * x0 * x2 * x3^3
  + 6012872747261677/2305843009213693952 * x1 * x2 * x3^3
  + 4797474444293847/18446744073709551616 * x2^2 * x3^3
  + -7303703172238657/144115188075855872 * x0 * x3^4
  + 2410499499460437/144115188075855872 * x1 * x3^4
  + -8672450915357903/2305843009213693952 * x2 * x3^4
  + -3424744186413973/288230376151711744 * x3^5
  + 2063439079468661/576460752303423488 * x0^6
  + -4712016037399159/1152921504606846976 * x0^5 * x1
  + 8953898528714897/2305843009213693952 * x0^4 * x1^2
  + -4840186173261891/1152921504606846976 * x0^3 * x1^3
  + 3011646854967243/1152921504606846976 * x0^2 * x1^4
  + -2951353048128371/4611686018427387904 * x0 * x1^5
  + 8872192412056023/18446744073709551616 * x1^6
  + -7026206444850649/4611686018427387904 * x0^5 * x2
  + 8945793983429683/4611686018427387904 * x0^4 * x1 * x2
  + -487711146968005/144115188075855872 * x0^3 * x1^2 * x2
  + 2748705006552729/1152921504606846976 * x0^2 * x1^3 * x2
  + -2711121600916755/576460752303423488 * x0 * x1^4 * x2
  + 5280725876647977/4611686018427387904 * x1^5 * x2
  + 3076401687882217/36028797018963968 * x0^4 * x2^2
  + -8522514949082035/576460752303423488 * x0^3 * x1 * x2^2
  + 2562517828219209/36028797018963968 * x0^2 * x1^2 * x2^2
  + -5115040617778971/288230376151711744 * x0 * x1^3 * x2^2
  + 4101842747041575/72057594037927936 * x1^4 * x2^2
  + -1035457995744659/72057594037927936 * x0^3 * x2^3
  + 2552347340417351/576460752303423488 * x0^2 * x1 * x2^3
  + -7847803392006327/576460752303423488 * x0 * x1^2 * x2^3
  + 4740393036110823/288230376151711744 * x1^3 * x2^3
  + 101668712570315/1125899906842624 * x0^2 * x2^4
  + -4951028244197605/576460752303423488 * x0 * x1 * x2^4
  + 5999539343379029/72057594037927936 * x1^2 * x2^4
  + -7003281707500069/576460752303423488 * x0 * x2^5
  + 189784163383481/18014398509481984 * x1 * x2^5
  + 7491594982257723/72057594037927936 * x2^6
  + -7974425360040209/4611686018427387904 * x0^5 * x3
  + -1041074320919353/2305843009213693952 * x0^4 * x1 * x3
  + 3655461529129567/9223372036854775808 * x0^3 * x1^2 * x3
  + -4030982965251671/9223372036854775808 * x0^2 * x1^3 * x3
  + 111229162811731/36028797018963968 * x0 * x1^4 * x3
  + 8342298002240689/36893488147419103232 * x1^5 * x3
  + -3777291288097689/18014398509481984 * x0^4 * x2 * x3
  + 1885664526649465/72057594037927936 * x0^3 * x1 * x2 * x3
  + -3073931955619097/18014398509481984 * x0^2 * x1^2 * x2 * x3
  + 2781883430888625/72057594037927936 * x0 * x1^3 * x2 * x3
  + -5157103070573931/36028797018963968 * x1^4 * x2 * x3
  + 1290465532876311/72057594037927936 * x0^3 * x2^2 * x3
  + -2414553206152799/576460752303423488 * x0^2 * x1 * x2^2 * x3
  + 4380137610547925/288230376151711744 * x0 * x1^2 * x2^2 * x3
  + -464245487645161/18014398509481984 * x1^3 * x2^2 * x3
  + -1936581621791325/9007199254740992 * x0^2 * x2^3 * x3
  + -7260958536184627/4611686018427387904 * x0 * x1 * x2^3 * x3
  + -7895061345782403/36028797018963968 * x1^2 * x2^3 * x3
  + 1977589713811813/576460752303423488 * x0 * x2^4 * x3
  + -7306004840911715/1152921504606846976 * x1 * x2^4 * x3
  + -333967679296977/1125899906842624 * x2^5 * x3
  + 1314369193810903/9007199254740992 * x0^4 * x3^2
  + -6216640168572931/288230376151711744 * x0^3 * x1 * x3^2
  + 8615810022762143/72057594037927936 * x0^2 * x1^2 * x3^2
  + -8362851376911427/288230376151711744 * x0 * x1^3 * x3^2
  + 3487568580482293/36028797018963968 * x1^4 * x3^2
  + 8125860707192405/576460752303423488 * x0^3 * x2 * x3^2
  + -402539367553877/288230376151711744 * x0^2 * x1 * x2 * x3^2
  + 7804904254754621/576460752303423488 * x0 * x1^2 * x2 * x3^2
  + -1444215793611129/144115188075855872 * x1^3 * x2 * x3^2
  + 4406966840245001/18014398509481984 * x0^2 * x2^2 * x3^2
  + 181240709373757/9007199254740992 * x0 * x1 * x2^2 * x3^2
  + 4822426954869133/18014398509481984 * x1^2 * x2^2 * x3^2
  + 1307902673832133/72057594037927936 * x0 * x2^3 * x3^2
  + -8961296288681499/576460752303423488 * x1 * x2^3 * x3^2
  + 5586735261255453/18014398509481984 * x2^4 * x3^2
  + -3984860283511483/144115188075855872 * x0^3 * x3^3
  + 3820122300923493/1152921504606846976 * x0^2 * x1 * x3^3
  + -7070853842415275/288230376151711744 * x0 * x1^2 * x3^3
  + 7819179181947631/288230376151711744 * x1^3 * x3^3
  + -2523520175056573/9007199254740992 * x0^2 * x2 * x3^3
  + -1470501689796077/72057594037927936 * x0 * x1 * x2 * x3^3
  + -5464475047956693/18014398509481984 * x1^2 * x2 * x3^3
  + 8102939092801645/1152921504606846976 * x0 * x2^2 * x3^3
  + -8864721673548007/4611686018427387904 * x1 * x2^2 * x3^3
  + -7181211349007135/36028797018963968 * x2^3 * x3^3
  + 3687417542159077/18014398509481984 * x0^2 * x3^4
  + -5120116797904503/1152921504606846976 * x0 * x1 * x3^4
  + 7247061328884299/36028797018963968 * x1^2 * x3^4
  + -3813273829434895/288230376151711744 * x0 * x2 * x3^4
  + 3545280439533145/288230376151711744 * x1 * x2 * x3^4
  + 6978337490196675/36028797018963968 * x2^2 * x3^4
  + -7186966617196903/288230376151711744 * x0 * x3^5
  + 7950477901318215/576460752303423488 * x1 * x3^5
  + -5944361719572057/18014398509481984 * x2 * x3^5
  + 4767949390824221/18014398509481984 * x3^6.
  
Lemma init_pos (x0 x1 x2 x3 : R) :
  p x0 x1 x2 x3
  - init_sigma1 x0 x1 x2 x3 * pI1 x0 x1 x2 x3
  - init_sigma2 x0 x1 x2 x3 * pI2 x0 x1 x2 x3
  - init_sigma3 x0 x1 x2 x3 * pI3 x0 x1 x2 x3
  - init_sigma4 x0 x1 x2 x3 * pI4 x0 x1 x2 x3 >= 0.
Proof.
rewrite /p /init_sigma1 /pI1 /init_sigma2 /pI2 /init_sigma3 /pI3 /init_sigma4 /pI4.
validsdp.
Qed.

Lemma init_sigma1_pos (x0 x1 x2 x3 : R) : init_sigma1 x0 x1 x2 x3 >= 0.
Proof. rewrite /init_sigma1. validsdp. Qed.

Lemma init_sigma2_pos (x0 x1 x2 x3 : R) : init_sigma2 x0 x1 x2 x3 >= 0.
Proof. rewrite /init_sigma2. validsdp. Qed.

Lemma init_sigma3_pos (x0 x1 x2 x3 : R) : init_sigma3 x0 x1 x2 x3 >= 0.
Proof. rewrite /init_sigma3. validsdp. Qed.

Lemma init_sigma4_pos (x0 x1 x2 x3 : R) : init_sigma4 x0 x1 x2 x3 >= 0.
Proof. rewrite /init_sigma4. validsdp. Qed.

Lemma ind0_pos (x0 x1 x2 x3 : R) :
  p (t0_x0 x0 x1 x2 x3) (t0_x1 x0 x1 x2 x3) (t0_x2 x0 x1 x2 x3) (t0_x3 x0 x1 x2 x3)
  - ind0_sigma x0 x1 x2 x3 * p x0 x1 x2 x3
  - ind0_sigma0 x0 x1 x2 x3 * g0 x0 x1 x2 x3 >= 0.
Proof.
rewrite /p /t0_x0 /t0_x1 /t0_x2 /t0_x3 /ind0_sigma /ind0_sigma0 /g0.
validsdp.
Qed.

Lemma ind0_sigma_pos (x0 x1 x2 x3 : R) : ind0_sigma x0 x1 x2 x3 >= 0.
Proof. rewrite /ind0_sigma. validsdp. Qed.

Lemma ind0_sigma0_pos (x0 x1 x2 x3 : R) : ind0_sigma0 x0 x1 x2 x3 >= 0.
Proof. rewrite /ind0_sigma0. validsdp. Qed.

Lemma ind1_pos (x0 x1 x2 x3 : R) :
  p (t1_x0 x0 x1 x2 x3) (t1_x1 x0 x1 x2 x3) (t1_x2 x0 x1 x2 x3) (t1_x3 x0 x1 x2 x3)
  - ind1_sigma x0 x1 x2 x3 * p x0 x1 x2 x3
  - ind1_sigma1 x0 x1 x2 x3 * g1 x0 x1 x2 x3 >= 0.
Proof.
rewrite /p /t1_x0 /t1_x1 /t1_x2 /t1_x3 /ind1_sigma /ind1_sigma1 /g1.
validsdp.
Qed.

Lemma ind1_sigma_pos (x0 x1 x2 x3 : R) : ind1_sigma x0 x1 x2 x3 >= 0.
Proof. rewrite /ind1_sigma. validsdp. Qed.

Lemma ind1_sigma1_pos (x0 x1 x2 x3 : R) : ind1_sigma1 x0 x1 x2 x3 >= 0.
Proof. rewrite /ind1_sigma1. validsdp. Qed.

Theorem init (x0 x1 x2 x3 : R) :
  pI1 x0 x1 x2 x3 >= 0 -> pI2 x0 x1 x2 x3 >= 0 -> pI3 x0 x1 x2 x3 >= 0 -> pI4 x0 x1 x2 x3 >= 0 ->
  p x0 x1 x2 x3 >= 0.
Proof.
move=> H1 H2 H3 H4.
apply (Rge_trans _ (p x0 x1 x2 x3 - init_sigma1 x0 x1 x2 x3 * pI1 x0 x1 x2 x3)).
{ rewrite -{1}(Rminus_0_r (p _ _ _ _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply init_sigma1_pos|]. }
apply (Rge_trans _ (p x0 x1 x2 x3 - init_sigma1 x0 x1 x2 x3 * pI1 x0 x1 x2 x3
                    - init_sigma2 x0 x1 x2 x3 * pI2 x0 x1 x2 x3)).
{ rewrite -{1}(Rminus_0_r (_ - _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply init_sigma2_pos|]. }
apply (Rge_trans _ (p x0 x1 x2 x3 - init_sigma1 x0 x1 x2 x3 * pI1 x0 x1 x2 x3
                    - init_sigma2 x0 x1 x2 x3 * pI2 x0 x1 x2 x3
                    - init_sigma3 x0 x1 x2 x3 * pI3 x0 x1 x2 x3)).
{ rewrite -{1}(Rminus_0_r (_ - _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply init_sigma3_pos|]. }
apply (Rge_trans _ (p x0 x1 x2 x3 - init_sigma1 x0 x1 x2 x3 * pI1 x0 x1 x2 x3
                    - init_sigma2 x0 x1 x2 x3 * pI2 x0 x1 x2 x3
                    - init_sigma3 x0 x1 x2 x3 * pI3 x0 x1 x2 x3
                    - init_sigma4 x0 x1 x2 x3 * pI4 x0 x1 x2 x3)).
{ rewrite -{1}(Rminus_0_r (_ - _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply init_sigma4_pos|]. }
apply init_pos.
Qed.

Theorem ind0 (x0 x1 x2 x3 : R) :
  p x0 x1 x2 x3 >= 0 -> g0 x0 x1 x2 x3 >= 0 -> 
  p (t0_x0 x0 x1 x2 x3) (t0_x1 x0 x1 x2 x3) (t0_x2 x0 x1 x2 x3) (t0_x3 x0 x1 x2 x3) >= 0.
Proof.
move=> H1 H2.
apply (Rge_trans _ (p (t0_x0 x0 x1 x2 x3) (t0_x1 x0 x1 x2 x3) (t0_x2 x0 x1 x2 x3) (t0_x3 x0 x1 x2 x3)
                    - ind0_sigma x0 x1 x2 x3 * p x0 x1 x2 x3)).
{ rewrite -{1}(Rminus_0_r (p _ _ _ _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply ind0_sigma_pos|]. }
apply (Rge_trans _ (p (t0_x0 x0 x1 x2 x3) (t0_x1 x0 x1 x2 x3) (t0_x2 x0 x1 x2 x3) (t0_x3 x0 x1 x2 x3)
                    - ind0_sigma x0 x1 x2 x3 * p x0 x1 x2 x3
                    - ind0_sigma0 x0 x1 x2 x3 * g0 x0 x1 x2 x3)).
{ rewrite -{1}(Rminus_0_r (_ - _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply ind0_sigma0_pos|]. }
apply ind0_pos.
Qed.

Theorem ind1 (x0 x1 x2 x3 : R) :
  p x0 x1 x2 x3 >= 0 -> g1 x0 x1 x2 x3 >= 0 ->
  p (t1_x0 x0 x1 x2 x3) (t1_x1 x0 x1 x2 x3) (t1_x2 x0 x1 x2 x3) (t1_x3 x0 x1 x2 x3) >= 0.
Proof.
move=> H1 H2.
apply (Rge_trans _ (p (t1_x0 x0 x1 x2 x3) (t1_x1 x0 x1 x2 x3) (t1_x2 x0 x1 x2 x3) (t1_x3 x0 x1 x2 x3)
                    - ind1_sigma x0 x1 x2 x3 * p x0 x1 x2 x3)).
{ rewrite -{1}(Rminus_0_r (p _ _ _ _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply ind1_sigma_pos|]. }
apply (Rge_trans _ (p (t1_x0 x0 x1 x2 x3) (t1_x1 x0 x1 x2 x3) (t1_x2 x0 x1 x2 x3) (t1_x3 x0 x1 x2 x3)
                    - ind1_sigma x0 x1 x2 x3 * p x0 x1 x2 x3
                    - ind1_sigma1 x0 x1 x2 x3 * g1 x0 x1 x2 x3)).
{ rewrite -{1}(Rminus_0_r (_ - _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply ind1_sigma1_pos|]. }
apply ind1_pos.
Qed.
