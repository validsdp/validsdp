From mathcomp Require Import ssreflect.
Require Import Reals.
From ValidSDP Require Import validsdp.

Local Open Scope R_scope.

(* Attempt to prove that p >= 0 with p below is an
 * inductive invariant, for the program
 *
x1 = rand(0.5, 0.7);
x2 = rand(0.5, 0.7);
while (-1 <= 0) {
  pre_x1 = x1; pre_x2 = x2;
  if (x1^2 + x2^2 <= 1) {
    x1 = pre_x1^2 + pre_x2^3;
    x2 = pre_x1^3 + pre_x2^2;
  } else {
    x1 = 0.5 * pre_x1^3 + 0.4 * pre_x2^2;
    x2 = -0.6 * pre_x1^2 + 0.3 * pre_x2^2;
  }
}
 *)

(* initial condition 0.5 <= x1 <= 0.7 encoded as (x1 - 0.5)*(0.7 - x1) (>= 0) *)
Let pI1 (x0 x1 : R) := (x0 - 5 / 10) * (7 / 10 - x0).
(* initial condition 0.5 <= x2 <= 0.7 *)
Let pI2 (x0 x1 : R) := (x1 - 5 / 10) * (7 / 10 - x1).
(* guard x1^2 + x2^2 <= 1 (then branch) *)
Let g0 x0 x1 := 1 - (x0^2 + x1^2).
(* assignment in then branch *)
Let t0_x0 (x0 x1 : R) := x0^2 + x1^3.
Let t0_x1 (x0 x1 : R) := x0^3 + x1^2.
(* guard x1^2 + x2^2 >= 1 (else branch) *)
Let g1 x0 x1 := (x0^2 + x1^2) - 1.
(* assignment in else branch *)
Let t1_x0 (x0 x1 : R) := 5 / 10 * x0^3 + 4 / 10 * x1^2.
Let t1_x1 (x0 x1 : R) := (-6) / 10 * x0^2 + 3 / 10 * x1^2.

Let p x0 x1 :=
  4738216471197271/4503599627370496 + 461486665561107/36028797018963968 * 
  x0 + 2148860567220837/72057594037927936 * x1
  + -8202775146209813/2251799813685248 * x0^2
  + -8626419234253377/4503599627370496 * x0 * x1
  + -7868078000648565/2251799813685248 * x1^2
  + 3921066891027203/1125899906842624 * x0^3
  + 2767544406545225/1125899906842624 * x0^2 * x1
  + 5506010582442379/2251799813685248 * x0 * x1^2
  + 3617072631418827/4503599627370496 * x1^3
  + -138133466777373/70368744177664 * x0^4
  + -8073725813518985/18014398509481984 * x0^3 * x1
  + 5942106187826601/1125899906842624 * x0^2 * x1^2
  + 6784102076241101/2251799813685248 * x0 * x1^3
  + -5823498136032391/36028797018963968 * x1^4
  + 1027144908312917/4503599627370496 * x0^5
  + -4727205476840271/9007199254740992 * x0^4 * x1
  + -5407525212435085/2251799813685248 * x0^3 * x1^2
  + -5224058528371821/2251799813685248 * x0^2 * x1^3
  + -7991748307902929/18014398509481984 * x0 * x1^4
  + 1505099781016865/1125899906842624 * x1^5
  + -4903820959533185/576460752303423488 * x0^6
  + 8376633397351463/288230376151711744 * x0^5 * x1
  + 7978081282562245/144115188075855872 * x0^4 * x1^2
  + -6712614333940499/36028797018963968 * x0^3 * x1^3
  + -3803524531712927/4503599627370496 * x0^2 * x1^4
  + -2951633102464389/2251799813685248 * x0 * x1^5
  + -4574065549448907/4503599627370496 * x1^6.
  
Let init_sigma1 x0 x1 :=
  1153617133019041/562949953421312 + 5996526295917263/72057594037927936 * 
  x0 + 5952508006036029/144115188075855872 * x1
  + 4884517623931267/2251799813685248 * x0^2
  + 6115579633406579/36028797018963968 * x0 * x1
  + 4974316296891207/4503599627370496 * x1^2
  + 6465627440972091/18014398509481984 * x0^3
  + 343489340931111/1125899906842624 * x0^2 * x1
  + 5692150194719479/18014398509481984 * x0 * x1^2
  + 1182062110862349/4503599627370496 * x1^3
  + 4939837651255945/2251799813685248 * x0^4
  + 3159575449726537/36028797018963968 * x0^3 * x1
  + 5282313543825389/4503599627370496 * x0^2 * x1^2
  + -5494950542796221/144115188075855872 * x0 * x1^3
  + 3974933568217023/2251799813685248 * x1^4.
  
Let init_sigma2 x0 x1 :=
  2787333897833483/2251799813685248 + -165208241580447/281474976710656 * 
  x0 + -9001589347703805/18014398509481984 * x1
  + 3025751689081663/4503599627370496 * x0^2
  + -7501057371367319/18014398509481984 * x0 * x1
  + 6518168750838009/4503599627370496 * x1^2
  + -3168821382025505/18014398509481984 * x0^3
  + 7380551696081533/72057594037927936 * x0^2 * x1
  + 4137601938924051/9007199254740992 * x0 * x1^2
  + 4712314091551883/9007199254740992 * x1^3
  + 3583248655071869/2251799813685248 * x0^4
  + -423586742059349/4503599627370496 * x0^3 * x1
  + 5831114240090313/4503599627370496 * x0^2 * x1^2
  + 7349670419071941/18014398509481984 * x0 * x1^3
  + 1520617695410427/562949953421312 * x1^4.
  
Let ind0_sigma x0 x1 :=
  6147534028504101/18014398509481984
  + -4489491017699883/9007199254740992 * x0
  + -798576596821525/4503599627370496 * x1
  + 8560180303123693/9007199254740992 * x0^2
  + -379305846284161/562949953421312 * x0 * x1
  + 5895354198837271/4503599627370496 * x1^2
  + -168071136107327/281474976710656 * x0^3
  + 7936866627920393/36028797018963968 * x0^2 * x1
  + -2391715693151435/2251799813685248 * x0 * x1^2
  + -4536333417538583/9007199254740992 * x1^3
  + 5690530196789427/4503599627370496 * x0^4
  + -4567850126451781/36028797018963968 * x0^3 * x1
  + 3634547209905973/4503599627370496 * x0^2 * x1^2
  + -7536452076356381/9007199254740992 * x0 * x1^3
  + 3937747047536603/2251799813685248 * x1^4
  + -1293248368398693/2251799813685248 * x0^5
  + -7888703650771223/144115188075855872 * x0^4 * x1
  + -8788180726885815/9007199254740992 * x0^3 * x1^2
  + -4587910522792205/4503599627370496 * x0^2 * x1^3
  + -5687843343624343/9007199254740992 * x0 * x1^4
  + -2473212721640663/4503599627370496 * x1^5
  + 3738834076830685/2251799813685248 * x0^6
  + -329186052235753/562949953421312 * x0^5 * x1
  + 2256840431943141/2251799813685248 * x0^4 * x1^2
  + -7366329462167767/9007199254740992 * x0^3 * x1^3
  + 324747457351683/562949953421312 * x0^2 * x1^4
  + -617090886888357/562949953421312 * x0 * x1^5
  + 1903197533558475/1125899906842624 * x1^6
  + -3281032223571503/9007199254740992 * x0^7
  + -6372202795221227/72057594037927936 * x0^6 * x1
  + -3778172415034721/4503599627370496 * x0^5 * x1^2
  + -1614019106477741/2251799813685248 * x0^4 * x1^3
  + -8379102593593871/9007199254740992 * x0^3 * x1^4
  + -6616652657259629/9007199254740992 * x0^2 * x1^5
  + -782731546776911/1125899906842624 * x0 * x1^6
  + -7350704784985237/9007199254740992 * x1^7
  + 3966906860678507/2251799813685248 * x0^8
  + -4450328088128297/9007199254740992 * x0^7 * x1
  + 282031969153739/281474976710656 * x0^6 * x1^2
  + -3189628825511775/4503599627370496 * x0^5 * x1^3
  + 4698102871780043/4503599627370496 * x0^4 * x1^4
  + -2642081565518277/2251799813685248 * x0^3 * x1^5
  + 4972590631217475/4503599627370496 * x0^2 * x1^6
  + -8517071443905175/9007199254740992 * x0 * x1^7
  + 259792986907827/140737488355328 * x1^8
  + 6232137874188011/72057594037927936 * x0^9
  + -2755713720925569/9007199254740992 * x0^8 * x1
  + -2668739384751431/18014398509481984 * x0^7 * x1^2
  + -8296426582226133/9007199254740992 * x0^6 * x1^3
  + -168175751541009/562949953421312 * x0^5 * x1^4
  + -5193456474366875/9007199254740992 * x0^4 * x1^5
  + -5664182778399867/9007199254740992 * x0^3 * x1^6
  + -8046431033868945/18014398509481984 * x0^2 * x1^7
  + -7787786080882327/9007199254740992 * x0 * x1^8
  + 5060001817936835/36028797018963968 * x1^9
  + 6739729557625009/2251799813685248 * x0^10
  + -2607161361565313/4503599627370496 * x0^9 * x1
  + 4034175307375671/2251799813685248 * x0^8 * x1^2
  + -5909549620995109/18014398509481984 * x0^7 * x1^3
  + 2407972222532261/2251799813685248 * x0^6 * x1^4
  + -7793021283216199/18014398509481984 * x0^5 * x1^5
  + 1787369450908677/2251799813685248 * x0^4 * x1^6
  + -3252415930974963/9007199254740992 * x0^3 * x1^7
  + 6972560726386447/4503599627370496 * x0^2 * x1^8
  + -2747656121329553/4503599627370496 * x0 * x1^9
  + 449475061358243/140737488355328 * x1^10
  + 7593173430343745/9007199254740992 * x0^11
  + 195088125890997/4503599627370496 * x0^10 * x1
  + -6096461283572593/36028797018963968 * x0^9 * x1^2
  + -4321491864896475/9007199254740992 * x0^8 * x1^3
  + -5388624269667871/9007199254740992 * x0^7 * x1^4
  + -3721102882254819/9007199254740992 * x0^6 * x1^5
  + -3524955009564029/18014398509481984 * x0^5 * x1^6
  + -826696616093835/1125899906842624 * x0^4 * x1^7
  + 1512330426358329/36028797018963968 * x0^3 * x1^8
  + -1165900285317701/2251799813685248 * x0^2 * x1^9
  + -5605536699335675/18014398509481984 * x0 * x1^10
  + 967202113178229/4503599627370496 * x1^11
  + 3723505849728115/1125899906842624 * x0^12
  + -3483410694857627/4503599627370496 * x0^11 * x1
  + 2444042083739161/1125899906842624 * x0^10 * x1^2
  + -505462108050983/1125899906842624 * x0^9 * x1^3
  + 8812371158381209/4503599627370496 * x0^8 * x1^4
  + -3100522084654693/4503599627370496 * x0^7 * x1^5
  + 4767532792478015/2251799813685248 * x0^6 * x1^6
  + -7384601134809933/18014398509481984 * x0^5 * x1^7
  + 4158702195598587/2251799813685248 * x0^4 * x1^8
  + -6813982163721753/18014398509481984 * x0^3 * x1^9
  + 5405860592753545/2251799813685248 * x0^2 * x1^10
  + -1590005452921251/2251799813685248 * x0 * x1^11
  + 7733385260920901/2251799813685248 * x1^12.
  
Let ind0_sigma0 x0 x1 :=
  6485960519575889/18014398509481984 + 5000992074063901/9007199254740992 * 
  x0 + 3142706370540755/9007199254740992 * x1
  + 1298913687725287/1125899906842624 * x0^2
  + 7385820250133629/4503599627370496 * x0 * x1
  + 5428431096925365/9007199254740992 * x1^2
  + -4387038417697797/2251799813685248 * x0^3
  + -8508657001151669/9007199254740992 * x0^2 * x1
  + -7977500019079877/4503599627370496 * x0 * x1^2
  + -4200631108694853/4503599627370496 * x1^3
  + -6211074230067913/9007199254740992 * x0^4
  + -6837135927081647/4503599627370496 * x0^3 * x1
  + -1624738019753601/2251799813685248 * x0^2 * x1^2
  + -2154592783778901/1125899906842624 * x0 * x1^3
  + -1356875610753355/4503599627370496 * x1^4
  + -855815112178523/281474976710656 * x0^5
  + -185700245111671/140737488355328 * x0^4 * x1
  + -5047690022209857/2251799813685248 * x0^3 * x1^2
  + -827218305280055/562949953421312 * x0^2 * x1^3
  + -2695245011586369/1125899906842624 * x0 * x1^4
  + -4767398668194017/2251799813685248 * x1^5
  + 1015540713688053/18014398509481984 * x0^6
  + -3873724704311501/4503599627370496 * x0^5 * x1
  + 1445381442986343/2251799813685248 * x0^4 * x1^2
  + -747748423251211/4503599627370496 * x0^3 * x1^3
  + 1098361993726995/1125899906842624 * x0^2 * x1^4
  + -7769625565100063/4503599627370496 * x0 * x1^5
  + 134881755109761/281474976710656 * x1^6
  + -6987923462841205/4503599627370496 * x0^7
  + -5608344530853977/72057594037927936 * x0^6 * x1
  + 8128958216435791/144115188075855872 * x0^5 * x1^2
  + 1286752175713201/1125899906842624 * x0^4 * x1^3
  + 4056670322021497/4503599627370496 * x0^3 * x1^4
  + 5860314309096845/18014398509481984 * x0^2 * x1^5
  + -7865342906853661/9007199254740992 * x0 * x1^6
  + -687712457541847/562949953421312 * x1^7
  + 792445568339147/562949953421312 * x0^8
  + 4052741331395637/9007199254740992 * x0^7 * x1
  + 5078747187273421/2251799813685248 * x0^6 * x1^2
  + 7583637677477263/4503599627370496 * x0^5 * x1^3
  + 7277252307228881/2251799813685248 * x0^4 * x1^4
  + 7145326658877697/4503599627370496 * x0^3 * x1^5
  + 2845211474133409/1125899906842624 * x0^2 * x1^6
  + -1867435281991159/4503599627370496 * x0 * x1^7
  + 993641072169929/562949953421312 * x1^8
  + -2540887917716357/36028797018963968 * x0^9
  + 4124005744532215/4503599627370496 * x0^8 * x1
  + 3764437662539237/2251799813685248 * x0^7 * x1^2
  + 4761134834594145/2251799813685248 * x0^6 * x1^3
  + 1513933194833213/562949953421312 * x0^5 * x1^4
  + 90030291127911/35184372088832 * x0^4 * x1^5
  + 4991887963814959/2251799813685248 * x0^3 * x1^6
  + 3517525236366437/2251799813685248 * x0^2 * x1^7
  + 5575077504317051/18014398509481984 * x0 * x1^8
  + 4071817009358357/144115188075855872 * x1^9
  + 3199477799067491/1125899906842624 * x0^10
  + 2772752208033399/2251799813685248 * x0^9 * x1
  + 7088139599183811/2251799813685248 * x0^8 * x1^2
  + 1318294669362705/562949953421312 * x0^7 * x1^3
  + 2090230894906059/562949953421312 * x0^6 * x1^4
  + 3362675812747377/1125899906842624 * x0^5 * x1^5
  + 8220393571185411/2251799813685248 * x0^4 * x1^6
  + 5322259202381179/2251799813685248 * x0^3 * x1^7
  + 6654106505654181/2251799813685248 * x0^2 * x1^8
  + 5669286557829497/9007199254740992 * x0 * x1^9
  + 6169959498608083/2251799813685248 * x1^10
  + 6236994577702631/4503599627370496 * x0^11
  + 6747805719887791/4503599627370496 * x0^10 * x1
  + 4714556511410245/2251799813685248 * x0^9 * x1^2
  + 5651272300178897/2251799813685248 * x0^8 * x1^3
  + 6438026183734683/2251799813685248 * x0^7 * x1^4
  + 1676834937669617/562949953421312 * x0^6 * x1^5
  + 6943563865675175/2251799813685248 * x0^5 * x1^6
  + 753625134715331/281474976710656 * x0^4 * x1^7
  + 5871177782532717/2251799813685248 * x0^3 * x1^8
  + 7685853833622733/4503599627370496 * x0^2 * x1^9
  + 5090877643957605/4503599627370496 * x0 * x1^10
  + 7280846055084851/9007199254740992 * x1^11
  + 8089271814618715/2251799813685248 * x0^12
  + 3218050037922881/2251799813685248 * x0^11 * x1
  + 3683707147327733/1125899906842624 * x0^10 * x1^2
  + 5051150674381987/2251799813685248 * x0^9 * x1^3
  + 1059612926148183/281474976710656 * x0^8 * x1^4
  + 3008478733049353/1125899906842624 * x0^7 * x1^5
  + 8886387628669531/2251799813685248 * x0^6 * x1^6
  + 6039340379159483/2251799813685248 * x0^5 * x1^7
  + 8044724396678789/2251799813685248 * x0^4 * x1^8
  + 4943943818395387/2251799813685248 * x0^3 * x1^9
  + 811866630773983/281474976710656 * x0^2 * x1^10
  + 4922727384466739/4503599627370496 * x0 * x1^11
  + 7052281951447905/2251799813685248 * x1^12
  + 134794230778143/70368744177664 * x0^13
  + 5812358880099673/4503599627370496 * x0^12 * x1
  + 5025601493432705/2251799813685248 * x0^11 * x1^2
  + 4391470468226251/2251799813685248 * x0^10 * x1^3
  + 6117331078106991/2251799813685248 * x0^9 * x1^4
  + 695140178571899/281474976710656 * x0^8 * x1^5
  + 6211865347010769/2251799813685248 * x0^7 * x1^6
  + 737308850914503/281474976710656 * x0^6 * x1^7
  + 2806400445466759/1125899906842624 * x0^5 * x1^8
  + 5066891130622831/2251799813685248 * x0^4 * x1^9
  + 8995207921212485/4503599627370496 * x0^3 * x1^10
  + 6628757334945083/4503599627370496 * x0^2 * x1^11
  + 5079068119899423/4503599627370496 * x0 * x1^12
  + 36424941069157/35184372088832 * x1^13
  + 1541340772930799/281474976710656 * x0^14
  + 2536735301044509/2251799813685248 * x0^13 * x1
  + 4791377130856923/1125899906842624 * x0^12 * x1^2
  + 7755772374903559/4503599627370496 * x0^11 * x1^3
  + 2173108268690005/562949953421312 * x0^10 * x1^4
  + 4973986940573645/2251799813685248 * x0^9 * x1^5
  + 4221789275473501/1125899906842624 * x0^8 * x1^6
  + 5166905807390015/2251799813685248 * x0^7 * x1^7
  + 8341393176105825/2251799813685248 * x0^6 * x1^8
  + 2296324701625369/1125899906842624 * x0^5 * x1^9
  + 8046957836212859/2251799813685248 * x0^4 * x1^10
  + 7035344158010845/4503599627370496 * x0^3 * x1^11
  + 7938266062202039/2251799813685248 * x0^2 * x1^12
  + 2115141914793325/2251799813685248 * x0 * x1^13
  + 2571312648351095/562949953421312 * x1^14
  + 6161200049333595/4503599627370496 * x0^15
  + 5484181947034259/9007199254740992 * x0^14 * x1
  + 5763179178102799/4503599627370496 * x0^13 * x1^2
  + 2964153751147291/2251799813685248 * x0^12 * x1^3
  + 6810532583221401/4503599627370496 * x0^11 * x1^4
  + 2029022834730197/1125899906842624 * x0^10 * x1^5
  + 7773468908225527/4503599627370496 * x0^9 * x1^6
  + 4292415887890001/2251799813685248 * x0^8 * x1^7
  + 8196639591042401/4503599627370496 * x0^7 * x1^8
  + 4029720273254385/2251799813685248 * x0^6 * x1^9
  + 6906739615394257/4503599627370496 * x0^5 * x1^10
  + 3545393510215645/2251799813685248 * x0^4 * x1^11
  + 2350227898439399/2251799813685248 * x0^3 * x1^12
  + 2262711104152949/2251799813685248 * x0^2 * x1^13
  + 1874197562837131/4503599627370496 * x0 * x1^14
  + 4549618201952843/4503599627370496 * x1^15
  + 4008077675242991/562949953421312 * x0^16
  + 1341297521633389/2251799813685248 * x0^15 * x1
  + 5070894635701517/1125899906842624 * x0^14 * x1^2
  + 1944580919024997/2251799813685248 * x0^13 * x1^3
  + 2252816136769147/562949953421312 * x0^12 * x1^4
  + 4679461272488667/4503599627370496 * x0^11 * x1^5
  + 276783873008527/70368744177664 * x0^10 * x1^6
  + 2783664054912051/2251799813685248 * x0^9 * x1^7
  + 4664388363053501/1125899906842624 * x0^8 * x1^8
  + 5535475279317541/4503599627370496 * x0^7 * x1^9
  + 269227885491393/70368744177664 * x0^6 * x1^10
  + 4483382111284095/4503599627370496 * x0^5 * x1^11
  + 4324649452024585/1125899906842624 * x0^4 * x1^12
  + 3032790003680353/4503599627370496 * x0^3 * x1^13
  + 8813927809208699/2251799813685248 * x0^2 * x1^14
  + 2525910990243359/288230376151711744 * x0 * x1^15
  + 738721602834057/140737488355328 * x1^16.
  
Let ind1_sigma x0 x1 :=
  3619911505627761/9007199254740992
  + 4383176458977411/1152921504606846976 * x0
  + -4662510311701723/288230376151711744 * x1
  + 5838456539805017/18014398509481984 * x0^2
  + -2935358982434911/18014398509481984 * x0 * x1
  + 175069531246189/562949953421312 * x1^2
  + -7842687252268145/288230376151711744 * x0^3
  + -6194134630415293/72057594037927936 * x0^2 * x1
  + -2932945383231075/144115188075855872 * x0 * x1^2
  + -3074639402948685/72057594037927936 * x1^3
  + 4831024454095079/18014398509481984 * x0^4
  + -2833796242394557/18014398509481984 * x0^3 * x1
  + 6872530459910801/36028797018963968 * x0^2 * x1^2
  + -1575660253632627/18014398509481984 * x0 * x1^3
  + 988035603380779/4503599627370496 * x1^4
  + 40704958058315/2251799813685248 * x0^5
  + -7618558652639399/72057594037927936 * x0^4 * x1
  + -1519359307563497/18014398509481984 * x0^3 * x1^2
  + -3289202538572417/36028797018963968 * x0^2 * x1^3
  + -4519911047924891/72057594037927936 * x0 * x1^4
  + -8405533779431717/288230376151711744 * x1^5
  + 8052299946464923/36028797018963968 * x0^6
  + -4733623941496821/36028797018963968 * x0^5 * x1
  + 7489368488423543/72057594037927936 * x0^4 * x1^2
  + -7731689571920597/72057594037927936 * x0^3 * x1^3
  + 886082002041429/9007199254740992 * x0^2 * x1^4
  + -2540221564081711/36028797018963968 * x0 * x1^5
  + 4544433304062689/18014398509481984 * x1^6
  + 1783510482115275/288230376151711744 * x0^7
  + -7849172515500617/72057594037927936 * x0^6 * x1
  + -2635565324705089/36028797018963968 * x0^5 * x1^2
  + -1537818726942389/18014398509481984 * x0^4 * x1^3
  + -1290948688623643/36028797018963968 * x0^3 * x1^4
  + -590641149933821/9007199254740992 * x0^2 * x1^5
  + -7421380363732227/288230376151711744 * x0 * x1^6
  + 8667704255173265/576460752303423488 * x1^7
  + 2163565147851779/9007199254740992 * x0^8
  + -4090929755181695/36028797018963968 * x0^7 * x1
  + 5203837878751947/36028797018963968 * x0^6 * x1^2
  + -5215541021980665/72057594037927936 * x0^5 * x1^3
  + 7213517439937685/72057594037927936 * x0^4 * x1^4
  + -2375833729730085/36028797018963968 * x0^3 * x1^5
  + 4952233756686989/36028797018963968 * x0^2 * x1^6
  + -8698896603611507/288230376151711744 * x0 * x1^7
  + 5391092595680377/18014398509481984 * x1^8
  + 1967202103337447/36028797018963968 * x0^9
  + -396979727587123/4503599627370496 * x0^8 * x1
  + -7816272760885349/288230376151711744 * x0^7 * x1^2
  + -1409689582997821/18014398509481984 * x0^6 * x1^3
  + -3863854644583943/72057594037927936 * x0^5 * x1^4
  + -8339579968528513/144115188075855872 * x0^4 * x1^5
  + -1733317989043113/36028797018963968 * x0^3 * x1^6
  + -2141272525553879/72057594037927936 * x0^2 * x1^7
  + -5529594389679529/144115188075855872 * x0 * x1^8
  + 3493365981270361/36028797018963968 * x1^9
  + 8850550064592003/18014398509481984 * x0^10
  + -8677353323599173/72057594037927936 * x0^9 * x1
  + 4753656784108781/18014398509481984 * x0^8 * x1^2
  + -8135001650974839/144115188075855872 * x0^7 * x1^3
  + 6314438290767657/36028797018963968 * x0^6 * x1^4
  + -3171562826224711/72057594037927936 * x0^5 * x1^5
  + 7069649742677439/36028797018963968 * x0^4 * x1^6
  + -7901092362671485/288230376151711744 * x0^3 * x1^7
  + 2494459070815419/9007199254740992 * x0^2 * x1^8
  + -5388857850136329/576460752303423488 * x0 * x1^9
  + 8568760809408699/18014398509481984 * x1^10
  + 5488264145053273/18014398509481984 * x0^11
  + -8409610426082863/72057594037927936 * x0^10 * x1
  + 5310612027924081/144115188075855872 * x0^9 * x1^2
  + -3600638985970871/36028797018963968 * x0^8 * x1^3
  + -5966322887487297/144115188075855872 * x0^7 * x1^4
  + -6797714642391529/144115188075855872 * x0^6 * x1^5
  + -1053073970882301/18014398509481984 * x0^5 * x1^6
  + -6341264168333259/144115188075855872 * x0^4 * x1^7
  + -93047270539043/2251799813685248 * x0^3 * x1^8
  + -5082270783736291/288230376151711744 * x0^2 * x1^9
  + -3590366500295925/36028797018963968 * x0 * x1^10
  + 2360724240266685/18014398509481984 * x1^11
  + 5916083212034935/4503599627370496 * x0^12
  + -3273611698299505/9007199254740992 * x0^11 * x1
  + 6139977143265827/9007199254740992 * x0^10 * x1^2
  + -435507890029323/2251799813685248 * x0^9 * x1^3
  + 2053426664859711/4503599627370496 * x0^8 * x1^4
  + -5661912312285941/36028797018963968 * x0^7 * x1^5
  + 7851326604792157/18014398509481984 * x0^6 * x1^6
  + -5312286495336625/36028797018963968 * x0^5 * x1^7
  + 3954719175349105/9007199254740992 * x0^4 * x1^8
  + -6239863213162197/36028797018963968 * x0^3 * x1^9
  + 5156379611136911/9007199254740992 * x0^2 * x1^10
  + -2254638478054337/9007199254740992 * x0 * x1^11
  + 6391734684681707/9007199254740992 * x1^12.
  
Let ind1_sigma1 x0 x1 :=
  7870556633278205/18014398509481984
  + -4841548813961767/36028797018963968 * x0
  + -5920958425541141/72057594037927936 * x1
  + 8099445933561567/36028797018963968 * x0^2
  + -1148174670804041/9007199254740992 * x0 * x1
  + 3963669078654571/18014398509481984 * x1^2
  + -1705797832461451/18014398509481984 * x0^3
  + -662875461312023/9007199254740992 * x0^2 * x1
  + -4278981746315565/36028797018963968 * x0 * x1^2
  + -3045080242583623/36028797018963968 * x1^3
  + 1516886511931327/9007199254740992 * x0^4
  + -6882172878229171/72057594037927936 * x0^3 * x1
  + 4595054351806943/72057594037927936 * x0^2 * x1^2
  + -5552910364092415/72057594037927936 * x0 * x1^3
  + 3682740509297605/18014398509481984 * x1^4
  + -6464350721087441/72057594037927936 * x0^5
  + -6466845272740473/72057594037927936 * x0^4 * x1
  + -726879231998279/9007199254740992 * x0^3 * x1^2
  + -2930909851091719/36028797018963968 * x0^2 * x1^3
  + -792451311188509/9007199254740992 * x0 * x1^4
  + -2475019063521099/36028797018963968 * x1^5
  + 3002952694045405/18014398509481984 * x0^6
  + -6873920157528219/72057594037927936 * x0^5 * x1
  + 7598613610248621/144115188075855872 * x0^4 * x1^2
  + -5402993806930217/72057594037927936 * x0^3 * x1^3
  + 4951371029391663/72057594037927936 * x0^2 * x1^4
  + -3045644497836801/36028797018963968 * x0 * x1^5
  + 5423734358127031/36028797018963968 * x1^6
  + -2713681122283563/36028797018963968 * x0^7
  + -7155210466137271/72057594037927936 * x0^6 * x1
  + -2710566834521821/36028797018963968 * x0^5 * x1^2
  + -2527253323363717/36028797018963968 * x0^4 * x1^3
  + -1318406148058177/18014398509481984 * x0^3 * x1^4
  + -8970460189734069/144115188075855872 * x0^2 * x1^5
  + -1631920150030923/18014398509481984 * x0 * x1^6
  + -5210185034502927/72057594037927936 * x1^7
  + 1740749206170105/9007199254740992 * x0^8
  + -3675341484864537/36028797018963968 * x0^7 * x1
  + 7230659208103607/144115188075855872 * x0^6 * x1^2
  + -4569962540425877/72057594037927936 * x0^5 * x1^3
  + 4087715492038191/72057594037927936 * x0^4 * x1^4
  + -3992770290080907/72057594037927936 * x0^3 * x1^5
  + 2546721018572635/36028797018963968 * x0^2 * x1^6
  + -3131275521763655/36028797018963968 * x0 * x1^7
  + 6305384060389931/36028797018963968 * x1^8
  + -319899180151167/4503599627370496 * x0^9
  + -3833077368179019/36028797018963968 * x0^8 * x1
  + -6404365541157353/72057594037927936 * x0^7 * x1^2
  + -607386250647215/9007199254740992 * x0^6 * x1^3
  + -6996025695451125/144115188075855872 * x0^5 * x1^4
  + -6473141572957839/144115188075855872 * x0^4 * x1^5
  + -4073473935386777/72057594037927936 * x0^3 * x1^6
  + -1009058937792011/18014398509481984 * x0^2 * x1^7
  + -7415165224928711/72057594037927936 * x0 * x1^8
  + -1233931018920831/18014398509481984 * x1^9
  + 7702260148520639/36028797018963968 * x0^10
  + -6482775796562683/72057594037927936 * x0^9 * x1
  + 5208457146174463/72057594037927936 * x0^8 * x1^2
  + -1183092403259163/18014398509481984 * x0^7 * x1^3
  + 2858767800775375/36028797018963968 * x0^6 * x1^4
  + -5820280951887509/144115188075855872 * x0^5 * x1^5
  + 6129088903452379/72057594037927936 * x0^4 * x1^6
  + -3555985246957217/72057594037927936 * x0^3 * x1^7
  + 6269932845545113/72057594037927936 * x0^2 * x1^8
  + -3563992056407375/36028797018963968 * x0 * x1^9
  + 882627343437517/4503599627370496 * x1^10
  + -421415896388569/4503599627370496 * x0^11
  + -1537861159045243/18014398509481984 * x0^10 * x1
  + -8126207043877307/72057594037927936 * x0^9 * x1^2
  + -4709913457867887/72057594037927936 * x0^8 * x1^3
  + -8410076870165821/144115188075855872 * x0^7 * x1^4
  + -35186204567561/1125899906842624 * x0^6 * x1^5
  + -6076362066431773/144115188075855872 * x0^5 * x1^6
  + -7361442807780801/288230376151711744 * x0^4 * x1^7
  + -301790051055069/4503599627370496 * x0^3 * x1^8
  + -2109330486008381/36028797018963968 * x0^2 * x1^9
  + -613732719975247/4503599627370496 * x0 * x1^10
  + -2387201187426463/36028797018963968 * x1^11
  + 5298681599572445/18014398509481984 * x0^12
  + -7670929709866123/288230376151711744 * x0^11 * x1
  + 5984296319503909/72057594037927936 * x0^10 * x1^2
  + -476692396141613/9007199254740992 * x0^9 * x1^3
  + 7196416740282301/72057594037927936 * x0^8 * x1^4
  + -5515315804010471/144115188075855872 * x0^7 * x1^5
  + 4215436809931785/36028797018963968 * x0^6 * x1^6
  + -5489537782715817/144115188075855872 * x0^5 * x1^7
  + 4548636707074123/36028797018963968 * x0^4 * x1^8
  + -5144358177385751/72057594037927936 * x0^3 * x1^9
  + 4403084526848757/36028797018963968 * x0^2 * x1^10
  + -5015908080435833/36028797018963968 * x0 * x1^11
  + 4992242931749673/18014398509481984 * x1^12
  + -3594866125779029/18014398509481984 * x0^13
  + 4931425992048267/72057594037927936 * x0^12 * x1
  + -2518235895470183/9007199254740992 * x0^11 * x1^2
  + 397361510861069/18014398509481984 * x0^10 * x1^3
  + -8900129188077611/72057594037927936 * x0^9 * x1^4
  + 5424155655151099/576460752303423488 * x0^8 * x1^5
  + -475722312360267/9007199254740992 * x0^7 * x1^6
  + 5942792153191329/576460752303423488 * x0^6 * x1^7
  + -3139966228383301/72057594037927936 * x0^5 * x1^8
  + -7057883238092485/4611686018427387904 * x0^4 * x1^9
  + -4920240737115945/72057594037927936 * x0^3 * x1^10
  + -7187643072773491/144115188075855872 * x0^2 * x1^11
  + -4635750811076743/36028797018963968 * x0 * x1^12
  + -6246931309819197/72057594037927936 * x1^13
  + 6925566784874095/36028797018963968 * x0^14
  + 1804984160072381/72057594037927936 * x0^13 * x1
  + -6180244717857073/36028797018963968 * x0^12 * x1^2
  + 3243052499571301/36028797018963968 * x0^11 * x1^3
  + 1826043383421825/288230376151711744 * x0^10 * x1^4
  + 2810510150527159/144115188075855872 * x0^9 * x1^5
  + 6424687048227033/72057594037927936 * x0^8 * x1^6
  + -9002099829977907/576460752303423488 * x0^7 * x1^7
  + 2013205370928207/18014398509481984 * x0^6 * x1^8
  + -4608212545357465/144115188075855872 * x0^5 * x1^9
  + 699278718726889/9007199254740992 * x0^4 * x1^10
  + -1514014956058791/36028797018963968 * x0^3 * x1^11
  + 7951488739103575/288230376151711744 * x0^2 * x1^12
  + -6428868435379775/72057594037927936 * x0 * x1^13
  + 395189308731753/2251799813685248 * x1^14
  + -2839767307973789/144115188075855872 * x0^15
  + 6222402425817533/72057594037927936 * x0^14 * x1
  + 6795030405549311/36028797018963968 * x0^13 * x1^2
  + 2982370795339445/18014398509481984 * x0^12 * x1^3
  + 1441767069191249/18014398509481984 * x0^11 * x1^4
  + -5367135576309285/288230376151711744 * x0^10 * x1^5
  + 741033049228689/9007199254740992 * x0^9 * x1^6
  + -6363934254087295/144115188075855872 * x0^8 * x1^7
  + 5895721464046133/72057594037927936 * x0^7 * x1^8
  + -6990310556365625/288230376151711744 * x0^6 * x1^9
  + 5630459552578727/72057594037927936 * x0^5 * x1^10
  + -2706154186368979/72057594037927936 * x0^4 * x1^11
  + 6307364073173519/72057594037927936 * x0^3 * x1^12
  + -1273624561183753/18014398509481984 * x0^2 * x1^13
  + 7872401601018465/72057594037927936 * x0 * x1^14
  + -5270458176274821/36028797018963968 * x1^15
  + 4857440010283759/4611686018427387904 * x0^16
  + -2683235087890279/4611686018427387904 * x0^15 * x1
  + 5821086827426157/576460752303423488 * x0^14 * x1^2
  + 8541590660373947/2305843009213693952 * x0^13 * x1^3
  + 5354830124476471/144115188075855872 * x0^12 * x1^4
  + 2310899155916011/36028797018963968 * x0^11 * x1^5
  + 6988257071380809/72057594037927936 * x0^10 * x1^6
  + 5707049920839975/72057594037927936 * x0^9 * x1^7
  + 4725955835787615/36028797018963968 * x0^8 * x1^8
  + 3039464563689239/36028797018963968 * x0^7 * x1^9
  + 7811116602110397/72057594037927936 * x0^6 * x1^10
  + 4957167943092807/72057594037927936 * x0^5 * x1^11
  + 6915481847761635/72057594037927936 * x0^4 * x1^12
  + 4722043536858055/72057594037927936 * x0^3 * x1^13
  + 3460263064613099/36028797018963968 * x0^2 * x1^14
  + 2758515169722835/18014398509481984 * x0 * x1^15
  + 212189897928693/1125899906842624 * x1^16.
  
Lemma init_pos (x0 x1 : R) :
  p x0 x1
  - init_sigma1 x0 x1 * pI1 x0 x1
  - init_sigma2 x0 x1 * pI2 x0 x1 >= 0.
Proof.
rewrite /p /init_sigma1 /pI1 /init_sigma2 /pI2.
do_sdp.
Qed.

Lemma init_sigma1_pos (x0 x1 : R) : init_sigma1 x0 x1 >= 0.
Proof. rewrite /init_sigma1. do_sdp. Qed.

Lemma init_sigma2_pos (x0 x1 : R) : init_sigma2 x0 x1 >= 0.
Proof. rewrite /init_sigma2. do_sdp. Qed.

Lemma ind0_pos (x0 x1 : R) :
  p (t0_x0 x0 x1) (t0_x1 x0 x1)
  - ind0_sigma x0 x1 * p x0 x1
  - ind0_sigma0 x0 x1 * g0 x0 x1 >= 0.
Proof.
rewrite /p /t0_x0 /t0_x1 /ind0_sigma /ind0_sigma0 /g0.
do_sdp.
Qed.

Lemma ind0_sigma_pos (x0 x1 : R) : ind0_sigma x0 x1 >= 0.
Proof. rewrite /ind0_sigma. do_sdp. Qed.

Lemma ind0_sigma0_pos (x0 x1 : R) : ind0_sigma0 x0 x1 >= 0.
Proof. rewrite /ind0_sigma0. do_sdp. Qed.

Lemma ind1_pos (x0 x1 : R) :
  p (t1_x0 x0 x1) (t1_x1 x0 x1)
  - ind1_sigma x0 x1 * p x0 x1
  - ind1_sigma1 x0 x1 * g1 x0 x1 >= 0.
Proof.
rewrite /p /t1_x0 /t1_x1 /ind1_sigma /ind1_sigma1 /g1.
do_sdp.
Qed.

Lemma ind1_sigma_pos (x0 x1 : R) : ind1_sigma x0 x1 >= 0.
Proof. rewrite /ind1_sigma. do_sdp. Qed.

Lemma ind1_sigma1_pos (x0 x1 : R) : ind1_sigma1 x0 x1 >= 0.
Proof. rewrite /ind1_sigma1. do_sdp. Qed.

Theorem init (x0 x1 x2 : R) :
  pI1 x0 x1 >= 0 -> pI2 x0 x1 >= 0 ->
  p x0 x1 >= 0.
Proof.
move=> H1 H2.
apply (Rge_trans _ (p x0 x1 - init_sigma1 x0 x1 * pI1 x0 x1)).
{ rewrite -{1}(Rminus_0_r (p _ _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply init_sigma1_pos|]. }
apply (Rge_trans _ (p x0 x1 - init_sigma1 x0 x1 * pI1 x0 x1
                    - init_sigma2 x0 x1 * pI2 x0 x1)).
{ rewrite -{1}(Rminus_0_r (_ - _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply init_sigma2_pos|]. }
apply init_pos.
Qed.

Theorem ind0 (x0 x1 : R) :
  p x0 x1 >= 0 -> g0 x0 x1 >= 0 -> 
  p (t0_x0 x0 x1) (t0_x1 x0 x1) >= 0.
Proof.
move=> H1 H2.
apply (Rge_trans _ (p (t0_x0 x0 x1) (t0_x1 x0 x1)
                    - ind0_sigma x0 x1 * p x0 x1)).
{ rewrite -{1}(Rminus_0_r (p _ _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply ind0_sigma_pos|]. }
apply (Rge_trans _ (p (t0_x0 x0 x1) (t0_x1 x0 x1)
                    - ind0_sigma x0 x1 * p x0 x1
                    - ind0_sigma0 x0 x1 * g0 x0 x1)).
{ rewrite -{1}(Rminus_0_r (_ - _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply ind0_sigma0_pos|]. }
apply ind0_pos.
Qed.

Theorem ind1 (x0 x1 : R) :
  p x0 x1 >= 0 -> g1 x0 x1 >= 0 ->
  p (t1_x0 x0 x1) (t1_x1 x0 x1) >= 0.
Proof.
move=> H1 H2.
apply (Rge_trans _ (p (t1_x0 x0 x1) (t1_x1 x0 x1)
                    - ind1_sigma x0 x1 * p x0 x1)).
{ rewrite -{1}(Rminus_0_r (p _ _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply ind1_sigma_pos|]. }
apply (Rge_trans _ (p (t1_x0 x0 x1) (t1_x1 x0 x1)
                    - ind1_sigma x0 x1 * p x0 x1
                    - ind1_sigma1 x0 x1 * g1 x0 x1)).
{ rewrite -{1}(Rminus_0_r (_ - _)).
  apply Rplus_ge_compat_l, Ropp_ge_contravar.
  by apply Rle_ge, Rmult_le_pos; apply Rge_le; [apply ind1_sigma1_pos|]. }
apply ind1_pos.
Qed.
