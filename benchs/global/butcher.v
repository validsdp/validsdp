From mathcomp Require Import ssreflect.
Require Import Reals.
From Interval Require Import Interval_tactic.
From ValidSDP Require Import validsdp.

Local Open Scope R_scope.

Let p (x0 x1 x2 x3 x4 x5 : R) :=
  x5 * (x1)^2 + x4 * (x2)^2 - x0 * (x3)^2 + (x3)^3 + (x3)^2 - 1/3 * x0
  + 4/3 * x3.

Let b1 (x0 x1 x2 x3 x4 x5 : R) :=
  (x0 + 1/1) * (0/1 - x0).

Let b2 (x0 x1 x2 x3 x4 x5 : R) :=
  (x1 + 1/10) * (9/10 - x1).

Let b3 (x0 x1 x2 x3 x4 x5 : R) :=
  (x2 + 1/10) * (5/10 - x2).

Let b4 (x0 x1 x2 x3 x4 x5 : R) :=
  (x3 + 1/1) * (-1/10 - x3).

Let b5 (x0 x1 x2 x3 x4 x5 : R) :=
  (x4 + 1/10) * (-5/100 - x4).

Let b6 (x0 x1 x2 x3 x4 x5 : R) :=
  (x5 + 1/10) * (-3/100 - x5).

Let lb := -14394/10000.

Let ub := 2191/10000.

Let lb_sigma (x0 x1 x2 x3 x4 x5 : R) :=
  2344504874707459/68719476736.

Let lb_sigma1 (x0 x1 x2 x3 x4 x5 : R) :=
  444524190005967/17179869184 + 532850562254845/68719476736 * x0
  + -326550996703081/34359738368 * x1 + -348777127156769/68719476736 * 
  x2 + 130653891346167/17179869184 * x3 + 108297423339039/68719476736 * 
  x4 + 94907807769151/68719476736 * x5 + 2648340996200681/68719476736 * 
  x0^2 + 210620408874945/68719476736 * x0 * x1
  + 1477733153672187/68719476736 * x1^2
  + 105642665185917/68719476736 * x0 * x2
  + -153829387180739/34359738368 * x1 * x2
  + 922964742892767/34359738368 * x2^2
  + -132650348358511/17179869184 * x0 * x3
  + 668900174617277/68719476736 * x1 * x3
  + 11390816094495/2147483648 * x2 * x3 + 955326525474065/34359738368 * 
  x3^2 + -34192468949573/34359738368 * x0 * x4
  + 9376019477177/8589934592 * x1 * x4 + 28233980721675/34359738368 * 
  x2 * x4 + -95687919360253/68719476736 * x3 * x4
  + 1122081637332053/34359738368 * x4^2
  + -60043904726283/68719476736 * x0 * x5
  + 43772028831617/34359738368 * x1 * x5 + 4767171368719/8589934592 * 
  x2 * x5 + -84953194251903/68719476736 * x3 * x5
  + -12170376584653/68719476736 * x4 * x5
  + 1141657904602387/34359738368 * x5^2.

Let lb_sigma2 (x0 x1 x2 x3 x4 x5 : R) :=
  579187221884453/34359738368 + -12565720565923/17179869184 * x0
  + -307200274495079/34359738368 * x1 + -145182930196585/34359738368 * 
  x2 + 834775579638853/34359738368 * x3 + 43709788789573/17179869184 * 
  x4 + 31710940483007/68719476736 * x5 + 2180892227007589/68719476736 * 
  x0^2 + -2576021957757/17179869184 * x0 * x1
  + 716479931221781/34359738368 * x1^2 + 1563542086635/17179869184 * 
  x0 * x2 + -189679234617087/34359738368 * x1 * x2
  + 1187541611415467/68719476736 * x2^2
  + 47606481375089/68719476736 * x0 * x3
  + 679280733340681/68719476736 * x1 * x3
  + 120757095933541/34359738368 * x2 * x3
  + 1124077826368663/68719476736 * x3^2
  + -19422749917051/68719476736 * x0 * x4
  + 34030177709195/34359738368 * x1 * x4
  + 60559784515249/34359738368 * x2 * x4
  + -39518194359923/17179869184 * x3 * x4
  + 1118807029255553/34359738368 * x4^2
  + 16436366300147/34359738368 * x0 * x5
  + 242536035202509/68719476736 * x1 * x5
  + 45351857020235/68719476736 * x2 * x5
  + -158935611324435/68719476736 * x3 * x5
  + -437394176003/2147483648 * x4 * x5 + 1126410903135041/34359738368 * 
  x5^2.

Let lb_sigma3 (x0 x1 x2 x3 x4 x5 : R) :=
  1293308213135473/68719476736 + -174410344762475/68719476736 * x0
  + -867966342989849/68719476736 * x1 + -403072984587853/68719476736 * 
  x2 + 1483653532500797/68719476736 * x3 + -803886591055/68719476736 * 
  x4 + 75439879553921/34359738368 * x5 + 316564657870987/8589934592 * 
  x0^2 + 37288345497593/68719476736 * x0 * x1
  + 1173958206161929/68719476736 * x1^2
  + -14136154468661/68719476736 * x0 * x2
  + -527782577608685/68719476736 * x1 * x2
  + 2561373101387093/68719476736 * x2^2 + -248921056251/34359738368 * 
  x0 * x3 + 828989761896549/68719476736 * x1 * x3
  + 505592021772289/68719476736 * x2 * x3 + 9739253970377/536870912 * 
  x3^2 + 8048076063175/8589934592 * x0 * x4
  + 78599740326805/34359738368 * x1 * x4
  + 53058660812165/34359738368 * x2 * x4
  + -163638083463469/68719476736 * x3 * x4
  + 588881663182641/17179869184 * x4^2 + 1794578290625/68719476736 * 
  x0 * x5 + 134278971786017/68719476736 * x1 * x5
  + 13173688360953/17179869184 * x2 * x5
  + -156829863399127/68719476736 * x3 * x5
  + -7883919634783/34359738368 * x4 * x5
  + 1162728355951155/34359738368 * x5^2.

Let lb_sigma4 (x0 x1 x2 x3 x4 x5 : R) :=
  1125013846745621/34359738368 + 239345246181425/34359738368 * x0
  + -722633290826443/68719476736 * x1 + -375347926839553/68719476736 * 
  x2 + -583309858156861/68719476736 * x3 + 41269740279923/68719476736 * 
  x4 + 18107357719975/34359738368 * x5 + 1992819922531551/68719476736 * 
  x0^2 + 57726449319819/34359738368 * x0 * x1
  + 210326860309121/8589934592 * x1^2 + 1621779586485/2147483648 * x0 * x2
  + -43560890386935/8589934592 * x1 * x2 + 500905291434055/17179869184 * 
  x2^2 + -314823362013471/68719476736 * x0 * x3
  + 349305688139815/34359738368 * x1 * x3
  + 91395685203327/17179869184 * x2 * x3 + 397017655679213/8589934592 * 
  x3^2 + -22509528173845/34359738368 * x0 * x4
  + 18776012117899/17179869184 * x1 * x4
  + 54472824632241/68719476736 * x2 * x4
  + -3432526652967/8589934592 * x3 * x4 + 1114735426131439/34359738368 * 
  x4^2 + -38264879535721/68719476736 * x0 * x5
  + 83904475524299/68719476736 * x1 * x5
  + 40295268067937/68719476736 * x2 * x5
  + -8292262890283/17179869184 * x3 * x5
  + -3836408030799/34359738368 * x4 * x5
  + 2226737632706013/68719476736 * x5^2.

Let lb_sigma5 (x0 x1 x2 x3 x4 x5 : R) :=
  3515112005659441/68719476736 + -153573324122095/34359738368 * x0
  + 597407353249861/68719476736 * x1 + 403658741093135/68719476736 * 
  x2 + -835601561556251/68719476736 * x3 + -120623861133477/68719476736 * 
  x4 + -99916770178229/68719476736 * x5 + 1248909609472023/34359738368 * 
  x0^2 + -63146759278923/68719476736 * x0 * x1
  + 2758157704300197/68719476736 * x1^2 + -4545667295027/8589934592 * 
  x0 * x2 + 116389136138977/34359738368 * x1 * x2
  + 2548318181026723/68719476736 * x2^2
  + 96490175269345/68719476736 * x0 * x3
  + -97944093182757/17179869184 * x1 * x3
  + -293497880498973/68719476736 * x2 * x3
  + 2910648597366075/68719476736 * x3^2 + 256142067827/8589934592 * x0 * x4
  + -2947781227061/4294967296 * x1 * x4
  + -17975929543741/34359738368 * x2 * x4
  + 30844864051769/34359738368 * x3 * x4
  + 3219702165368953/68719476736 * x4^2 + 7064760637475/34359738368 * 
  x0 * x5 + -47782922590877/68719476736 * x1 * x5
  + -31913902041525/68719476736 * x2 * x5
  + 30560170016275/34359738368 * x3 * x5
  + 1641269591173/17179869184 * x4 * x5 + 2386377833126665/68719476736 * 
  x5^2.

Let lb_sigma6 (x0 x1 x2 x3 x4 x5 : R) :=
  6038527897791893/68719476736 + -206003360449541/68719476736 * x0
  + 3101738010385349/68719476736 * x1 + 1278617042232881/68719476736 * 
  x2 + -1755272002395801/34359738368 * x3 + -129277138379559/34359738368 * 
  x4 + -267724118807459/68719476736 * x5 + 38089668938227/1073741824 * 
  x0^2 + -17521561491509/68719476736 * x0 * x1
  + 4702727609507593/68719476736 * x1^2
  + -5650419440707/34359738368 * x0 * x2
  + 1063567375810975/68719476736 * x1 * x2
  + 2858367634893845/68719476736 * x2^2 + 4077368107329/8589934592 * 
  x0 * x3 + -1404732598530807/34359738368 * x1 * x3
  + -1174131517366635/68719476736 * x2 * x3
  + 5259582580245589/68719476736 * x3^2 + 6437322669389/68719476736 * 
  x0 * x4 + -205260761907335/68719476736 * x1 * x4
  + -98952411939951/68719476736 * x2 * x4
  + 222108816196859/68719476736 * x3 * x4
  + 1199341841886833/34359738368 * x4^2
  + -3005577325329/34359738368 * x0 * x5
  + -199889007858989/68719476736 * x1 * x5
  + -50172874039011/34359738368 * x2 * x5
  + 111120914233189/34359738368 * x3 * x5
  + 19361170370767/68719476736 * x4 * x5
  + 3202554901634001/68719476736 * x5^2.

Let ub_sigma (x0 x1 x2 x3 x4 x5 : R) :=
  98232876171113/140737488355328.

Let ub_sigma1 (x0 x1 x2 x3 x4 x5 : R) :=
  4186834680382221/144115188075855872
  + -7709289687219113/72057594037927936 * x0
  + 5952889991136337/604462909807314587353088 * x1
  + 4032017648455321/604462909807314587353088 * x2
  + -5273636561920393/288230376151711744 * x3
  + 8336577433903381/2417851639229258349412352 * x4
  + 2079309120200495/604462909807314587353088 * x5
  + 1774660877438129/18014398509481984 * x0^2
  + -1777503117105463/151115727451828646838272 * x0 * x1
  + 7560972276142425/590295810358705651712 * x1^2
  + -3200018174559117/302231454903657293676544 * x0 * x2
  + 8967646426439865/18889465931478580854784 * x1 * x2
  + 953633228815415/295147905179352825856 * x2^2
  + 4855757489580385/144115188075855872 * x0 * x3
  + -6764497987751/4722366482869645213696 * x1 * x3
  + -119543685035905/75557863725914323419136 * x2 * x3
  + 6650716092517151/2305843009213693952 * x3^2
  + -758616808693277/151115727451828646838272 * x0 * x4
  + 1058007901284285/1208925819614629174706176 * x1 * x4
  + 479387087515121/2417851639229258349412352 * x2 * x4
  + -1696985756331955/2417851639229258349412352 * x3 * x4
  + 1902747473417337/590295810358705651712 * x4^2
  + -760684120633917/151115727451828646838272 * x0 * x5
  + 303072213176947/1208925819614629174706176 * x1 * x5
  + -307017779504773/1208925819614629174706176 * x2 * x5
  + -1724590738621385/2417851639229258349412352 * x3 * x5
  + -39633329835425/2417851639229258349412352 * x4 * x5
  + 3805461609525613/1180591620717411303424 * x5^2.

Let ub_sigma2 (x0 x1 x2 x3 x4 x5 : R) :=
  7606890882658885/2361183241434822606848
  + 3662312666975493/2417851639229258349412352 * x0
  + -3732682080723513/151115727451828646838272 * x1
  + 1766949723567405/1208925819614629174706176 * x2
  + 623751444583089/2417851639229258349412352 * x3
  + 238902716860943/604462909807314587353088 * x4
  + 4712241256220651/604462909807314587353088 * x5
  + 3868939824838767/1180591620717411303424 * x0^2
  + 2276865858554007/590295810358705651712 * x0 * x1
  + 5178107438934547/73786976294838206464 * x1^2
  + -1417632222360449/2417851639229258349412352 * x0 * x2
  + -881822302612603/302231454903657293676544 * x1 * x2
  + 8404808455265223/2361183241434822606848 * x2^2
  + -225023356107379/1208925819614629174706176 * x0 * x3
  + 3477545549252761/1208925819614629174706176 * x1 * x3
  + 6056137288465331/2417851639229258349412352 * x2 * x3
  + 475723097515623/147573952589676412928 * x3^2
  + -1422800854960255/302231454903657293676544 * x0 * x4
  + -3169493292391349/18889465931478580854784 * x1 * x4
  + 3762751442096449/302231454903657293676544 * x2 * x4
  + -462165154929139/1208925819614629174706176 * x3 * x4
  + 1902059062655537/590295810358705651712 * x4^2
  + -322534390116939/295147905179352825856 * x0 * x5
  + -5599716942105097/147573952589676412928 * x1 * x5
  + 2359904628141319/604462909807314587353088 * x2 * x5
  + -3624973770996877/2417851639229258349412352 * x3 * x5
  + 7105567893867669/151115727451828646838272 * x4 * x5
  + 5076678364924583/590295810358705651712 * x5^2.

Let ub_sigma3 (x0 x1 x2 x3 x4 x5 : R) :=
  3803680248252605/1180591620717411303424
  + -337238688040577/604462909807314587353088 * x0
  + -474612710341989/2417851639229258349412352 * x1
  + -5494892843191075/37778931862957161709568 * x2
  + 614848952770467/2417851639229258349412352 * x3
  + 4841944517893523/151115727451828646838272 * x4
  + 160474667089241/1208925819614629174706176 * x5
  + 8064062356703925/2361183241434822606848 * x0^2
  + 4181314036864601/2417851639229258349412352 * x0 * x1
  + 238000929929077/73786976294838206464 * x1^2
  + 5115224107399319/295147905179352825856 * x0 * x2
  + 8751979683981629/75557863725914323419136 * x1 * x2
  + 3611471668069277/9223372036854775808 * x2^2
  + -179083557366217/1208925819614629174706176 * x0 * x3
  + -403251232557415/2417851639229258349412352 * x1 * x3
  + 2969469143739867/2417851639229258349412352 * x2 * x3
  + 7610222587745643/2361183241434822606848 * x3^2
  + -280316167625449/73786976294838206464 * x0 * x4
  + -5273323052194095/302231454903657293676544 * x1 * x4
  + -6279127401688763/36893488147419103232 * x2 * x4
  + -1004520031418801/1208925819614629174706176 * x3 * x4
  + 3228225953020657/147573952589676412928 * x4^2
  + -750106446510217/1208925819614629174706176 * x0 * x5
  + -528231395911865/604462909807314587353088 * x1 * x5
  + -4073090659543179/2417851639229258349412352 * x2 * x5
  + -803352200051049/2417851639229258349412352 * x3 * x5
  + 1174565040954983/2417851639229258349412352 * x4 * x5
  + 7612804942776605/2361183241434822606848 * x5^2.

Let ub_sigma4 (x0 x1 x2 x3 x4 x5 : R) :=
  5048589856027963/9007199254740992 + -991010720067455/4503599627370496 * 
  x0 + -3381224790722233/295147905179352825856 * x1
  + -6365044249757121/75557863725914323419136 * x2
  + 2109808955743587/4503599627370496 * x3
  + -2580512819450361/590295810358705651712 * x4
  + -1668346181090429/73786976294838206464 * x5
  + 3112962998138981/144115188075855872 * x0^2
  + 5307501692736521/2361183241434822606848 * x0 * x1
  + 7607590452555817/2361183241434822606848 * x1^2
  + 2223442164241745/151115727451828646838272 * x0 * x2
  + -615696695242967/604462909807314587353088 * x1 * x2
  + 951329308936755/295147905179352825856 * x2^2
  + -1656585819477493/18014398509481984 * x0 * x3
  + -2824476908120395/590295810358705651712 * x1 * x3
  + -8710504653242349/302231454903657293676544 * x2 * x3
  + 7053797819930125/72057594037927936 * x3^2
  + 4032598926827685/4722366482869645213696 * x0 * x4
  + 2414452578549583/2417851639229258349412352 * x1 * x4
  + 5581879915483003/2417851639229258349412352 * x2 * x4
  + -8570969269202815/4722366482869645213696 * x3 * x4
  + 7616353332003293/2361183241434822606848 * x4^2
  + 5234668608392151/1180591620717411303424 * x0 * x5
  + 424371797421119/302231454903657293676544 * x1 * x5
  + 6816817751415097/2417851639229258349412352 * x2 * x5
  + -5569966965141011/590295810358705651712 * x3 * x5
  + 2725388108899239/604462909807314587353088 * x4 * x5
  + 7617986800544671/2361183241434822606848 * x5^2.

Let ub_sigma5 (x0 x1 x2 x3 x4 x5 : R) :=
  5667378959020003/147573952589676412928
  + -1750902698146377/18446744073709551616 * x0
  + 4404913702932867/147573952589676412928 * x1
  + 5512835350428135/18889465931478580854784 * x2
  + -5570347048306509/2417851639229258349412352 * x3
  + 6137602107806971/147573952589676412928 * x4
  + 100680456722787/302231454903657293676544 * x5
  + 2502975705089829/36893488147419103232 * x0^2
  + -6390950652671827/147573952589676412928 * x0 * x1
  + 372675673110921/2305843009213693952 * x1^2
  + -4902169950094339/4611686018427387904 * x0 * x2
  + 5700031194900565/302231454903657293676544 * x1 * x2
  + 1348020797649285/562949953421312 * x2^2
  + 1823770883589655/604462909807314587353088 * x0 * x3
  + -3240949026802563/2417851639229258349412352 * x1 * x3
  + -2354220388003559/2417851639229258349412352 * x2 * x3
  + 475609315811803/147573952589676412928 * x3^2
  + -1824339600627167/36893488147419103232 * x0 * x4
  + 3594096760622107/2417851639229258349412352 * x1 * x4
  + 1171199110577019/2417851639229258349412352 * x2 * x4
  + -1867984838278935/2417851639229258349412352 * x3 * x4
  + 2954169963390279/73786976294838206464 * x4^2
  + -4709484273669767/151115727451828646838272 * x0 * x5
  + 896999937841253/2417851639229258349412352 * x1 * x5
  + 893114897424169/1208925819614629174706176 * x2 * x5
  + -1997321794232453/2417851639229258349412352 * x3 * x5
  + 8334467986283493/604462909807314587353088 * x4 * x5
  + 4949346641968791/295147905179352825856 * x5^2.

Let ub_sigma6 (x0 x1 x2 x3 x4 x5 : R) :=
  2096085883751995/73786976294838206464
  + -2299761614194593/36893488147419103232 * x0
  + 854220082162753/2361183241434822606848 * x1
  + 1589303160351997/37778931862957161709568 * x2
  + -4825281148539027/2417851639229258349412352 * x3
  + 6647499175030997/2417851639229258349412352 * x4
  + -310534654877023/1208925819614629174706176 * x5
  + 6194588749290803/147573952589676412928 * x0^2
  + -6015622931739801/4611686018427387904 * x0 * x1
  + 6568511666305823/2251799813685248 * x1^2
  + -5034136663230237/151115727451828646838272 * x0 * x2
  + 1517405560187791/302231454903657293676544 * x1 * x2
  + 3814806491148187/1180591620717411303424 * x2^2
  + 2877403198306143/1208925819614629174706176 * x0 * x3
  + -2127684968859395/2417851639229258349412352 * x1 * x3
  + -95464595122329/302231454903657293676544 * x2 * x3
  + 237805260446001/73786976294838206464 * x3^2
  + -5422857033338351/604462909807314587353088 * x0 * x4
  + 64583889894117/1208925819614629174706176 * x1 * x4
  + 1087056708891377/2417851639229258349412352 * x2 * x4
  + -381356412119377/604462909807314587353088 * x3 * x4
  + 3860384375524577/1180591620717411303424 * x4^2
  + -8814060815131597/151115727451828646838272 * x0 * x5
  + 227000678376487/604462909807314587353088 * x1 * x5
  + -8916504732436151/2417851639229258349412352 * x2 * x5
  + -455598165883709/604462909807314587353088 * x3 * x5
  + 7380496701511999/75557863725914323419136 * x4 * x5
  + 968850260262951/36893488147419103232 * x5^2.

Lemma lb_pos (x0 x1 x2 x3 x4 x5 : R) :
  lb_sigma x0 x1 x2 x3 x4 x5 * (p x0 x1 x2 x3 x4 x5 - lb)
  - lb_sigma1 x0 x1 x2 x3 x4 x5 * b1 x0 x1 x2 x3 x4 x5
  - lb_sigma2 x0 x1 x2 x3 x4 x5 * b2 x0 x1 x2 x3 x4 x5
  - lb_sigma3 x0 x1 x2 x3 x4 x5 * b3 x0 x1 x2 x3 x4 x5
  - lb_sigma4 x0 x1 x2 x3 x4 x5 * b4 x0 x1 x2 x3 x4 x5
  - lb_sigma5 x0 x1 x2 x3 x4 x5 * b5 x0 x1 x2 x3 x4 x5
  - lb_sigma6 x0 x1 x2 x3 x4 x5 * b6 x0 x1 x2 x3 x4 x5 >= 0.
Proof.
rewrite /p /lb /lb_sigma /lb_sigma1 /b1 /lb_sigma2 /b2 /lb_sigma3 /b3
        /lb_sigma4 /b4 /lb_sigma5 /b5 /lb_sigma6 /b6.
validsdp.
Qed.

Lemma lb_sigma_pos (x0 x1 x2 x3 x4 x5 : R) : lb_sigma x0 x1 x2 x3 x4 x5 > 0.
Proof. rewrite /lb_sigma. interval. Qed.

Lemma lb_sigma1_pos (x0 x1 x2 x3 x4 x5 : R) : lb_sigma1 x0 x1 x2 x3 x4 x5 >= 0.
Proof. rewrite /lb_sigma1. validsdp. Qed.

Lemma lb_sigma2_pos (x0 x1 x2 x3 x4 x5 : R) : lb_sigma2 x0 x1 x2 x3 x4 x5 >= 0.
Proof. rewrite /lb_sigma2. validsdp. Qed.

Lemma lb_sigma3_pos (x0 x1 x2 x3 x4 x5 : R) : lb_sigma3 x0 x1 x2 x3 x4 x5 >= 0.
Proof. rewrite /lb_sigma3. validsdp. Qed.

Lemma lb_sigma4_pos (x0 x1 x2 x3 x4 x5 : R) : lb_sigma4 x0 x1 x2 x3 x4 x5 >= 0.
Proof. rewrite /lb_sigma4. validsdp. Qed.

Lemma lb_sigma5_pos (x0 x1 x2 x3 x4 x5 : R) : lb_sigma5 x0 x1 x2 x3 x4 x5 >= 0.
Proof. rewrite /lb_sigma5. validsdp. Qed.

Lemma lb_sigma6_pos (x0 x1 x2 x3 x4 x5 : R) : lb_sigma6 x0 x1 x2 x3 x4 x5 >= 0.
Proof. rewrite /lb_sigma6. validsdp. Qed.

Lemma ub_pos (x0 x1 x2 x3 x4 x5 : R) :
  ub_sigma x0 x1 x2 x3 x4 x5 * (ub - p x0 x1 x2 x3 x4 x5)
  - ub_sigma1 x0 x1 x2 x3 x4 x5 * b1 x0 x1 x2 x3 x4 x5
  - ub_sigma2 x0 x1 x2 x3 x4 x5 * b2 x0 x1 x2 x3 x4 x5
  - ub_sigma3 x0 x1 x2 x3 x4 x5 * b3 x0 x1 x2 x3 x4 x5
  - ub_sigma4 x0 x1 x2 x3 x4 x5 * b4 x0 x1 x2 x3 x4 x5
  - ub_sigma5 x0 x1 x2 x3 x4 x5 * b5 x0 x1 x2 x3 x4 x5
  - ub_sigma6 x0 x1 x2 x3 x4 x5 * b6 x0 x1 x2 x3 x4 x5 >= 0.
Proof.
rewrite /p /ub /ub_sigma /ub_sigma1 /b1 /ub_sigma2 /b2 /ub_sigma3 /b3
        /ub_sigma4 /b4 /ub_sigma5 /b5 /ub_sigma6 /b6.
validsdp.
Qed.

Lemma ub_sigma_pos (x0 x1 x2 x3 x4 x5 : R) : ub_sigma x0 x1 x2 x3 x4 x5 > 0.
Proof. rewrite /ub_sigma. interval. Qed.

Lemma ub_sigma1_pos (x0 x1 x2 x3 x4 x5 : R) : ub_sigma1 x0 x1 x2 x3 x4 x5 >= 0.
Proof. rewrite /ub_sigma1. validsdp. Qed.

Lemma ub_sigma2_pos (x0 x1 x2 x3 x4 x5 : R) : ub_sigma2 x0 x1 x2 x3 x4 x5 >= 0.
Proof. rewrite /ub_sigma2. validsdp. Qed.

Lemma ub_sigma3_pos (x0 x1 x2 x3 x4 x5 : R) : ub_sigma3 x0 x1 x2 x3 x4 x5 >= 0.
Proof. rewrite /ub_sigma3. validsdp. Qed.

Lemma ub_sigma4_pos (x0 x1 x2 x3 x4 x5 : R) : ub_sigma4 x0 x1 x2 x3 x4 x5 >= 0.
Proof. rewrite /ub_sigma4. validsdp. Qed.

Lemma ub_sigma5_pos (x0 x1 x2 x3 x4 x5 : R) : ub_sigma5 x0 x1 x2 x3 x4 x5 >= 0.
Proof. rewrite /ub_sigma5. validsdp. Qed.

Lemma ub_sigma6_pos (x0 x1 x2 x3 x4 x5 : R) : ub_sigma6 x0 x1 x2 x3 x4 x5 >= 0.
Proof. rewrite /ub_sigma6. validsdp. Qed.

Lemma var_bounds (x l u : R) : l <= x <= u -> (x - l) * (u - x) >= 0.
Proof.
move=> [Hl Hu].
apply Rle_ge.
by apply Interval_missing.Rmult_le_pos_pos; apply Fcore_Raux.Rle_0_minus.
Qed.

Lemma relax (x y z : R) : x >= 0 -> y >= 0 -> z - x * y >= 0 -> z >= 0.
Proof.
move=> HX Hy.
apply Rge_trans, Rle_ge.
rewrite -{2}(Rminus_0_r z).
apply Rplus_le_compat_l, Ropp_le_contravar.
by apply Interval_missing.Rmult_le_pos_pos; apply Rge_le.
Qed.
  
Theorem p_ge_lb (x0 x1 x2 x3 x4 x5 : R) :
  -1 <= x0 <= 0 -> -1/10 <= x1 <= 9/10 -> -1/10 <= x2 <= 5/10 -> -1 <= x3 <= -1/10 -> -1/10 <= x4 <= -5/100 -> -1/10 <= x5 <= -3/100 ->
  lb <= p x0 x1 x2 x3 x4 x5.
Proof.
move=> H0 H1 H2 H3 H4 H5.
have Hb0 : b1 x0 x1 x2 x3 x4 x5 >= 0.
{ rewrite /b1 -(Ropp_involutive (_ / _)).
  by apply var_bounds; rewrite -Ropp_div !Rcomplements.Rdiv_1. }
have Hb1 : b2 x0 x1 x2 x3 x4 x5 >= 0.
{ rewrite /b2 -(Ropp_involutive (_ / _)).
  by apply var_bounds; rewrite -Ropp_div. }
have Hb2 : b3 x0 x1 x2 x3 x4 x5 >= 0.
{ rewrite /b3 -(Ropp_involutive (_ / _)).
  by apply var_bounds; rewrite -Ropp_div. }
have Hb3 : b4 x0 x1 x2 x3 x4 x5 >= 0.
{ rewrite /b4 -(Ropp_involutive (_ / _)).
  by apply var_bounds; rewrite -Ropp_div Rcomplements.Rdiv_1. }
have Hb4 : b5 x0 x1 x2 x3 x4 x5 >= 0.
{ rewrite /b5 -(Ropp_involutive (_ / _)).
  by apply var_bounds; rewrite -Ropp_div. }
have Hb5 : b6 x0 x1 x2 x3 x4 x5 >= 0.
{ rewrite /b6 -(Ropp_involutive (_ / _)).
  by apply var_bounds; rewrite -Ropp_div. }
apply Rge_le, Rminus_ge, Rle_ge.
apply (Rmult_le_reg_l (lb_sigma x0 x1 x2 x3 x4 x5)); [by apply lb_sigma_pos|].
rewrite Rmult_0_r; apply Rge_le.
apply (relax _ _ _ (lb_sigma1_pos x0 x1 x2 x3 x4 x5) Hb0).
apply (relax _ _ _ (lb_sigma2_pos x0 x1 x2 x3 x4 x5) Hb1).
apply (relax _ _ _ (lb_sigma3_pos x0 x1 x2 x3 x4 x5) Hb2).
apply (relax _ _ _ (lb_sigma4_pos x0 x1 x2 x3 x4 x5) Hb3).
apply (relax _ _ _ (lb_sigma5_pos x0 x1 x2 x3 x4 x5) Hb4).
apply (relax _ _ _ (lb_sigma6_pos x0 x1 x2 x3 x4 x5) Hb5).
apply lb_pos.
Qed.

Theorem p_le_ub (x0 x1 x2 x3 x4 x5 : R) :
  -1 <= x0 <= 0 -> -1/10 <= x1 <= 9/10 -> -1/10 <= x2 <= 5/10 -> -1 <= x3 <= -1/10 -> -1/10 <= x4 <= -5/100 -> -1/10 <= x5 <= -3/100 ->
  p x0 x1 x2 x3 x4 x5 <= ub.
Proof.
move=> H0 H1 H2 H3 H4 H5.
have Hb0 : b1 x0 x1 x2 x3 x4 x5 >= 0.
{ rewrite /b1 -(Ropp_involutive (_ / _)).
  by apply var_bounds; rewrite -Ropp_div !Rcomplements.Rdiv_1. }
have Hb1 : b2 x0 x1 x2 x3 x4 x5 >= 0.
{ rewrite /b2 -(Ropp_involutive (_ / _)).
  by apply var_bounds; rewrite -Ropp_div. }
have Hb2 : b3 x0 x1 x2 x3 x4 x5 >= 0.
{ rewrite /b3 -(Ropp_involutive (_ / _)).
  by apply var_bounds; rewrite -Ropp_div. }
have Hb3 : b4 x0 x1 x2 x3 x4 x5 >= 0.
{ rewrite /b4 -(Ropp_involutive (_ / _)).
  by apply var_bounds; rewrite -Ropp_div Rcomplements.Rdiv_1. }
have Hb4 : b5 x0 x1 x2 x3 x4 x5 >= 0.
{ rewrite /b5 -(Ropp_involutive (_ / _)).
  by apply var_bounds; rewrite -Ropp_div. }
have Hb5 : b6 x0 x1 x2 x3 x4 x5 >= 0.
{ rewrite /b6 -(Ropp_involutive (_ / _)).
  by apply var_bounds; rewrite -Ropp_div. }
apply Rge_le, Rminus_ge, Rle_ge.
apply (Rmult_le_reg_l (ub_sigma x0 x1 x2 x3 x4 x5)); [by apply ub_sigma_pos|].
rewrite Rmult_0_r; apply Rge_le.
apply (relax _ _ _ (ub_sigma1_pos x0 x1 x2 x3 x4 x5) Hb0).
apply (relax _ _ _ (ub_sigma2_pos x0 x1 x2 x3 x4 x5) Hb1).
apply (relax _ _ _ (ub_sigma3_pos x0 x1 x2 x3 x4 x5) Hb2).
apply (relax _ _ _ (ub_sigma4_pos x0 x1 x2 x3 x4 x5) Hb3).
apply (relax _ _ _ (ub_sigma5_pos x0 x1 x2 x3 x4 x5) Hb4).
apply (relax _ _ _ (ub_sigma6_pos x0 x1 x2 x3 x4 x5) Hb5).
apply ub_pos.
Qed.
